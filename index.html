<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Agumento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/flowbite@1.4.7/dist/flowbite.min.css" />
    <script src="https://unpkg.com/vue@3"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="gsap-public/minified/gsap.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarpanch&family=Saira:wght@100;300;600&display=swap"
        rel="stylesheet">
    <script>
        if (!window.indexedDB) {
            console.log("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");
        }
    </script>
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        * {
            margin: 0;
        }

        html,
        body {
            height: 100%;
        }

        body {
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        img,
        picture,
        video,
        canvas,
        svg {
            display: block;
            max-width: 100%;
        }

        input,
        button,
        textarea,
        select {
            font: inherit;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Saira', sans-serif;
            font-weight: 600;
            overflow-wrap: break-word;
        }

        p,
        li {
            font-family: 'Sarpanch', sans-serif;
        }

        a,
        button,
        input,
        optgroup,
        select,
        textarea {
            font-family: 'Saira', sans-serif !important;
        }

        a {
            cursor: pointer;
        }

        #app {
            position: relative;
        }

        .v-enter-active,
        .v-enter-from {
            transition-delay: .25s !important;
        }

        .v-enter-active,
        .v-leave-active {
            transition: opacity 0.25s ease;
        }

        .v-enter-from,
        .v-leave-to {
            opacity: 0;
        }

        .loading {
            opacity: 0;
        }

        .filter-hover {
            filter: url(#noise);
        }

        .lines-v1 {
            position: absolute;
            top: 0%;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 200px, rgb(30, 41, 59, .2) 200px, rgb(30, 41, 59, .2) 201px, transparent 201px, transparent 204px, transparent 205px);
        }

        .lines-v2 {
            position: absolute;
            top: 0%;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(90deg, transparent, transparent 200px, rgb(30, 41, 59, .2) 200px, rgb(30, 41, 59, .2) 201px, transparent 201px, transparent 204px, transparent 205px);
        }

        .lines-h1 {
            position: absolute;
            top: 0%;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(0deg, transparent, transparent 200px, rgb(30, 41, 59, .2) 200px, rgb(30, 41, 59, .2) 201px, transparent 201px, transparent 204px, transparent 205px);
            animation: movev 25s linear infinite alternate;
        }

        .lines-h2 {
            position: absolute;
            top: 0%;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(0deg, transparent, transparent 200px, rgb(30, 41, 59, .2) 200px, rgb(30, 41, 59, .2) 201px, transparent 201px, transparent 204px, transparent 205px);
            animation: movev 5s linear infinite alternate-reverse;

        }

        @keyframes movev {
            0% {
                background-position-y: 0;
            }

            100% {
                background-position-y: 500px;
            }
        }

        @keyframes moveh {
            0% {
                background-position-x: 0;
            }

            100% {
                background-position-x: 500px;
            }
        }

        .modal-mask {
            position: fixed;
            z-index: 9998;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: table;
            transition: opacity 0.3s ease;
        }

        .modal-wrapper {
            display: table-cell;
            vertical-align: middle;
        }

        .modal-container {
            margin: 0px auto;
            background-color: #fff;
            border-radius: 2px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.33);
            transition: all 0.3s ease;
        }

        .modal-enter-from {
            opacity: 0;
        }

        .modal-leave-to {
            opacity: 0;
        }

        .modal-enter-from .modal-container,
        .modal-leave-to .modal-container {
            -webkit-transform: scale(1.1);
            transform: scale(1.1);
        }
    </style>
</head>

<body>

    <div id="app">
        <div class="bg-slate-900 text-neutral-content">
            <div id="main" class="min-h-screen relative z-10 loading">
                <nav class="px-2 sm:px-4 py-2.5">
                    <div class="container flex flex-wrap justify-between items-center mx-auto">
                        <a class="flex items-center">
                            <span class="text-white self-center text-xl font-semibold whitespace-nowrap">Agumento</span>
                        </a>
                        <div class="flex md:order-2">
                            <button type="button" @click="newsheetmodal = true"
                                class="svg-filtered text-white bg-gradient-to-br from-indigo-800 to-cyan-500 focus:ring-4 focus:outline-none focus:ring-indigo-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2 mb-2"
                                type="button">Get started</button>
                            <button data-collapse-toggle="mobile-menu-4" type="button"
                                class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200"
                                aria-controls="mobile-menu-4" aria-expanded="false">
                                <span class="sr-only">Open main menu</span>
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                        clip-rule="evenodd"></path>
                                </svg>
                                <svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                        </div>
                        <div class="hidden justify-between items-center w-full md:flex md:w-auto md:order-1"
                            id="mobile-menu-4">
                            <ul class="flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium">
                                <li>
                                    <a @click="setCurrentPage('home')"
                                        class="svg-filtered block text-lg py-2 pr-4 pl-3 text-white hover:text-indigo-200"
                                        aria-current="page">Home</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('about')"
                                        class="svg-filtered block text-lg py-2 pr-4 pl-3 text-white hover:text-indigo-200">About</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('agumento-programs')"
                                        class="svg-filtered block text-lg py-2 pr-4 pl-3 text-white hover:text-indigo-200">Agumento
                                        programs</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('my-programs')"
                                        class="svg-filtered block text-lg py-2 pr-4 pl-3 text-white hover:text-indigo-200">My
                                        programs</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>

                <!-- Content -->
                <div class="container mx-auto py-8 min-h-screen">
                    <Transition>
                        <div class="pb-12 relative" v-if="currentPage == 'home'">
                            <section>
                                <div class="py-8 px-4 mx-auto max-w-screen-xl text-center lg:py-16 lg:px-12">
                                    <a href="#"
                                        class="inline-flex justify-between items-center py-1 px-1 pr-4 mb-7 text-sm text-gray-700 bg-gray-100 rounded-full dark:bg-gray-800 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-700"
                                        role="alert">
                                        <span
                                            class="text-xs bg-primary-600 rounded-full text-white px-4 py-1.5 mr-3">New</span>
                                        <span class="text-sm font-medium">Agumento premade programs</span>
                                        <svg class="ml-2 w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd"
                                                d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                                clip-rule="evenodd"></path>
                                        </svg>
                                    </a>
                                    <h1 id="main-heading"
                                        class="mb-4 text-4xl font-extrabold tracking-tight leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white">
                                        Get your Workouts done</h1>
                                    <p
                                        class="mb-8 text-lg font-normal text-gray-500 lg:text-xl sm:px-16 xl:px-48 dark:text-gray-400">
                                        Work hard, reach your goals, build your custom training program with modular
                                        approach, do only exercises you like!</p>
                                    <div
                                        class="flex flex-col mb-8 lg:mb-16 space-y-4 sm:flex-row sm:justify-center sm:space-y-0 sm:space-x-4">
                                        <a href="#"
                                            class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-900">
                                            How it works
                                            <svg class="ml-2 -mr-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd"
                                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </a>
                                        <button
                                            class="relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium text-slate-900 rounded-lg group bg-gradient-to-br from-indigo-800 to-cyan-500 group-hover:from-indigo-800 group-hover:to-cyan-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-indigo-800 shadow-lg shadow-cyan-900/90">
                                            <span
                                                class="w-full relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
                                                <svg class="inline-block mr-2 -ml-1 w-5 h-5" fill="none"
                                                    stroke="currentColor" viewBox="0 0 24 24"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                                    </path>
                                                </svg>
                                                My sheets
                                            </span>
                                        </button>
                                    </div>
                                </div>
                            </section>

                            <div class="my-8">
                                <h2 class="text-white mb-8 text-2xl font-bold lg:text-3xl">
                                    My custom modules
                                </h2>
                                <div class="flex gap-4" v-if="mymodules.length">
                                    <div class="p-6 h-full max-w-sm bg-slate-800 rounded-lg border border-slate-600 shadow-md"
                                        v-for="(module, moduleindex) in mymodules">
                                        <a href="#">
                                            <h5 class="mb-2 text-2xl font-bold tracking-tight text-white">
                                                {{module.title}}</h5>
                                        </a>
                                        <p class="mb-3 font-normal text-slate-400">
                                            Here are the biggest enterprise technology acquisitions of 2021 so far, in
                                            reverse chronological order.
                                        <ul>
                                            <li v-for="ex in module.exs" class="mb-3 font-normal text-slate-400">
                                                {{ ex.name }}
                                                <p class="text-sm">{{ ex.description }}</p>
                                            </li>
                                        </ul>
                                        </p>
                                        <button @click="assignmodule(module.key)"
                                            class="w-full my-5 relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium text-slate-900 rounded-lg group bg-gradient-to-br from-indigo-800 to-cyan-500 group-hover:from-indigo-800 group-hover:to-cyan-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-indigo-800 shadow-lg shadow-cyan-900/90">
                                            <span
                                                class="w-full relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
                                                Add to sheet
                                                <svg class="inline-block ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd"
                                                        d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                        clip-rule="evenodd"></path>
                                                </svg>
                                            </span>
                                        </button>
                                        <form v-if="assigning == module.key" class="my-6 space-y-6" action="#"
                                            @submit.prevent="assigntosheet">
                                            <div>
                                                <label for="mysheets"
                                                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Sheets</label>
                                                <select name="sheet"
                                                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-indigo-500 dark:focus:border-indigo-500">
                                                    <option v-for="(sheet, index) in mysheets" :value="sheet.key">
                                                        {{sheet.title}}</option>
                                                </select>
                                                <input type="hidden" name="exindex" :value="exindex" />
                                                <input type="hidden" name="moduleindex" :value="moduleindex" />
                                            </div>
                                            <button type="submit"
                                                class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Add</button>
                                        </form>
                                        <button @click="moduleformtype = 'edit'; newmodulemodal = true; editmodule = JSON.parse(JSON.stringify(module))" type="button"
                                            class="cursor-pointer inline-flex items-center mt-5 mr-2 py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700"
                                            type="button">Edit module</button>
                                        <span @click="removefromdb(module.key, 'mymodules')"
                                            class="cursor-pointer inline-flex items-center mt-5 py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">Remove</span>
                                    </div>
                                </div>
                                <div v-else>
                                    <p class="text-slate-400">No modules created yet</p>
                                </div>
                                <div class="my-5">
                                    <button type="button" @click="newmodulemodal = true; editmodule = {}"
                                        class="svg-filtered text-white bg-gradient-to-br from-indigo-800 to-cyan-500 focus:ring-4 focus:outline-none focus:ring-indigo-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2 mb-2"
                                        type="button">Add your module</button>
                                </div>
                            </div>
                            <div class="" v-for="(element, exindex) in data.plans">
                                <div class="my-8">
                                    <h2 class="text-white mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                        {{element.title}}
                                    </h2>
                                    <p class="mx-auto text-slate-400 md:text-lg">
                                        {{element.description}}
                                    </p>
                                </div>
                                <div class="flex gap-4">
                                    <div class="p-6 h-full max-w-sm bg-slate-800 rounded-lg border border-slate-600 shadow-md"
                                        v-for="(module, moduleindex) in element.modules">
                                        <a href="#">
                                            <h5 class="mb-2 text-2xl font-bold tracking-tight text-white">
                                                {{module.title}}</h5>
                                        </a>
                                        <p class="mb-3 font-normal text-slate-400">
                                            Here are the biggest enterprise technology acquisitions of 2021 so far, in
                                            reverse chronological order.
                                        <ul>
                                            <li v-for="ex in module.exs" class="mb-3 font-normal text-slate-400">
                                                {{ ex.name }}
                                                <p class="text-sm">{{ ex.description }}</p>
                                            </li>
                                        </ul>
                                        </p>
                                        <button @click="assignmodule(module.key)"
                                            class="w-full my-5 relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium text-slate-900 rounded-lg group bg-gradient-to-br from-indigo-800 to-cyan-500 group-hover:from-indigo-800 group-hover:to-cyan-500 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-indigo-800 shadow-lg shadow-cyan-900/90">
                                            <span
                                                class="w-full relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-opacity-0">
                                                Add to sheet
                                                <svg class="inline-block ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd"
                                                        d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                        clip-rule="evenodd"></path>
                                                </svg>
                                            </span>
                                        </button>
                                        <form v-if="assigning == module.key" class="my-6 space-y-6" action="#"
                                            @submit.prevent="assigntosheet">
                                            <div>
                                                <label for="mysheets"
                                                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Sheets</label>
                                                <select name="sheet"
                                                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-indigo-500 dark:focus:border-indigo-500">
                                                    <option v-for="(sheet, index) in mysheets" :value="sheet.key">
                                                        {{sheet.title}}</option>
                                                </select>
                                                <input type="hidden" name="exindex" :value="exindex" />
                                                <input type="hidden" name="moduleindex" :value="moduleindex" />
                                            </div>
                                            <button type="submit"
                                                class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Add</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <form class="my-6 space-y-6" @submit.prevent="importtodb">
                                    <label class="block">
                                        <span class="sr-only">Data file</span>
                                        <input type="file" name="file" class="block w-full text-sm text-slate-500
                                          file:mr-4 file:py-2 file:px-4
                                          file:rounded-full file:border-0
                                          file:text-sm file:font-semibold
                                          file:bg-indigo-50 file:text-indigo-700
                                          hover:file:bg-indigo-100
                                        "/>
                                    </label>
                                    <button type="submit"
                                        class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Import</button>
                                </form>
                                <div class="my-3">
                                    <button type="button" @click="exportdb"
                                        class="svg-filtered text-white bg-gradient-to-br from-indigo-800 to-cyan-500 focus:ring-4 focus:outline-none focus:ring-indigo-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2 mb-2"
                                        type="button">Export data</button>
                                </div>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'about'">
                            <div class="container mx-auto py-8">
                                <h2 class="text-white mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                    about
                                </h2>
                                <p class="text-slate-400">
                                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    incididunt ut labore et dolore magna aliqua.
                                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                                    ex ea commodo consequat.
                                    Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
                                    fugiat nulla pariatur.
                                    Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
                                    mollit anim id est laborum</p>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'my-programs'">
                            <div class="container mx-auto py-8">
                                <h2 class="text-white mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                    My saved modules
                                </h2>
                                <div v-for="sheet in mysheets" class="my-4">
                                    <a @click="setCurrentPage(sheet.key)"
                                        class="block p-6 max-w-sm bg-white rounded-lg border border-gray-200 shadow-md hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
                                        <h5
                                            class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">
                                            {{sheet.title}}</h5>
                                        <p class="font-normal text-gray-700 dark:text-gray-400">Here are the biggest
                                            enterprise technology acquisitions of 2021 so far, in reverse chronological
                                            order.</p>
                                        <span @click="removefromdb(sheet.key, 'mysheets')"
                                            class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">Remove</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'agumento-programs'">
                            <div>
                                <div v-for="sheet in data.sheets">
                                    <div class="my-8">
                                        <h2 class="text-white mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                            {{sheet.name}}
                                        </h2>
                                        <div class="relative overflow-x-auto shadow-md rounded-lg">
                                            <table
                                                class="w-full text-sm text-left text-gray-400 bg-slate-800 table-auto my-4"
                                                v-for="(set, key) in sheet.modules">
                                                <thead class="text-xs uppercase bg-gray-700 text-gray-400">
                                                    <tr>
                                                        <th
                                                            class="border-b text-left border-slate-600 p-4 pl-8 text-slate-400">
                                                            #</th>
                                                        <th
                                                            class="border-b text-left border-slate-600 p-4 pl-8 text-slate-400">
                                                            #</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="bg-slate-800">
                                                    <tr v-for="(el, key) in data.plans[set.type].modules[set.id].exs"
                                                        class="border-b bg-gray-800 border-gray-700">
                                                        <td class="border-b border-slate-600 p-4 pl-8 text-slate-400">
                                                            {{el.name}}</td>
                                                        <td class="border-b border-slate-600 p-4 pl-8 text-slate-400">
                                                            {{el.description}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else>
                            <div v-for="sheet in mysheets">
                                <div v-if="currentPage == sheet.key">
                                    <div class="container mx-auto py-8">
                                        <h2 class="text-white mb-2 text-2xl font-bold lg:text-4xl md:mb-2">
                                            {{sheet.title}}
                                        </h2>
                                        <div>
                                            <div v-if="sheet.assignedModules">
                                                <div class="flex flex-wrap gap-10">
                                                    <div class="h-full">
                                                        <div class="py-8">
                                                            <h3
                                                                class="text-white mb-2 text-2xl font-medium lg:text-3xl md:mb-2">
                                                                My modules</h3>
                                                        </div>
                                                        <div class="grid grid-cols-2 gap-4 h-full">
                                                            <div class="p-6 max-w-sm bg-slate-800 rounded-lg border border-slate-600 shadow-md"
                                                                v-for="module in sheet.assignedModules">
                                                                <a href="#">
                                                                    <h5
                                                                        class="mb-2 text-2xl font-bold tracking-tight text-white">
                                                                        {{module.title}}</h5>
                                                                </a>
                                                                <p class="mb-3 font-normal text-slate-400">
                                                                    Here are the biggest enterprise technology
                                                                    acquisitions of 2021 so far, in reverse
                                                                    chronological order.
                                                                <ul>
                                                                    <li v-for="ex in module.exs"
                                                                        class="mb-3 font-normal text-slate-400">
                                                                        {{ ex.name }}
                                                                        <p class="text-sm">{{ ex.description }}</p>
                                                                    </li>
                                                                </ul>
                                                                </p>
                                                                <a @click="deletemodule(sheet.key, module.key)"
                                                                    class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">
                                                                    Remove
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div class="py-8">
                                                            <h3
                                                                class="text-white mb-2 text-2xl font-medium lg:text-3xl md:mb-2">
                                                                My goals</h3>
                                                        </div>
                                                        <div v-if="sheet.goals">
                                                            <ol class="relative border-l border-gray-700 py-4">
                                                                <li class="mb-10 ml-4" v-for="goal in sheet.goals">
                                                                    <div :class="[goal.reached ? 'bg-indigo-300 shadow-md' : 'bg-gray-700']"
                                                                        class="absolute w-3 h-3 rounded-full mt-1.5 -left-1.5 border border-gray-900">
                                                                    </div>
                                                                    <h3
                                                                        class="text-lg font-semibold text-gray-900 dark:text-white">
                                                                        {{goal.title}}</h3>
                                                                    <p
                                                                        class="mb-4 text-base font-normal text-gray-500 dark:text-gray-400">
                                                                        {{goal.message}}</p>
                                                                    <a @click="setgoalreached(sheet.key, goal.title)"
                                                                        class="inline-flex items-center py-2 px-4 mr-3 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">Set
                                                                        as reached <svg class="ml-2 w-3 h-3"
                                                                            fill="currentColor" viewBox="0 0 20 20"
                                                                            xmlns="http://www.w3.org/2000/svg">
                                                                            <path fill-rule="evenodd"
                                                                                d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
                                                                                clip-rule="evenodd"></path>
                                                                        </svg></a>
                                                                    <a @click="deletegoal(sheet.key, goal.title)"
                                                                        class="inline-flex items-center py-2 px-4 text-sm font-medium text-gray-900 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-indigo-700 focus:z-10 focus:ring-4 focus:outline-none focus:ring-gray-200 focus:text-indigo-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700 dark:focus:ring-gray-700">Remove</a>
                                                                </li>
                                                            </ol>
                                                        </div>
                                                        <div v-else>
                                                            <p class="text-slate-400">No goals created yet</p>
                                                        </div>
                                                        <a @click="newgoalform()"
                                                            class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-white bg-indigo-600 rounded-lg hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300">
                                                            Add new goal
                                                            <svg class="ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                                viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                                <path fill-rule="evenodd"
                                                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                                    clip-rule="evenodd"></path>
                                                            </svg>
                                                        </a>
                                                        <form v-if="goalform" class="my-6 space-y-6 max-w-sm" action="#"
                                                            @submit.prevent="assigngoaltosheet">
                                                            <div>
                                                                <div class="pb-4">
                                                                    <label for="goal_title"
                                                                        class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Title</label>
                                                                    <input type="text" id="goal_title" name="goal_title"
                                                                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-indigo-500 dark:focus:border-indigo-500"
                                                                        placeholder="HSPU" required>
                                                                </div>
                                                                <div class="pb-4">
                                                                    <label for="motivation_message"
                                                                        class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400">Your
                                                                        motivation</label>
                                                                    <textarea id="motivation_message"
                                                                        name="motivation_message" rows="4"
                                                                        class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-indigo-500 dark:focus:border-indigo-500"
                                                                        placeholder="Your motivation message..."></textarea>
                                                                </div>
                                                                <input type="hidden" name="key" :value="sheet.key" />
                                                            </div>
                                                            <button type="submit"
                                                                class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Add</button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div v-else>
                                                <p class="text-slate-400">No modules assigned yet</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Transition>
                </div>
                <footer class="p-4 bg-white shadow md:flex md:items-center md:justify-between md:p-6 dark:bg-gray-800">
                    <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">Â© 2022 <a href="."
                            class="hover:underline">Agumento</a>
                    </span>
                    <ul class="flex flex-wrap items-center mt-3 text-sm text-gray-500 dark:text-gray-400 sm:mt-0">
                        <li>
                            <a @click="setCurrentPage('home')" class="mr-4 hover:underline md:mr-6">Home</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('about')" class="mr-4 hover:underline md:mr-6">about</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('agumento-programs')" class="mr-4 hover:underline md:mr-6">Agumento
                                programs</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('my-programs')" class="hover:underline">my programs</a>
                        </li>
                    </ul>
                </footer>
            </div>
            <!-- add sheet modal -->
            <Transition name="modal">
                <div v-if="newsheetmodal" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto rounded-lg shadow bg-gray-700">
                            <button type="button" @click="newsheetmodal = false"
                                class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 class="mb-4 text-xl font-medium text-gray-900 dark:text-white">Register new sheet
                                </h3>
                                <form class="space-y-6" action="#" @submit.prevent="newSheet">
                                    <div>
                                        <label for="mysheet"
                                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Title</label>
                                        <input type="text" name="mysheet" id="mysheet"
                                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                                            placeholder="My first sheet" required>
                                    </div>
                                    <button type="submit"
                                        class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Assign</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
            <!-- add module modal -->
            <Transition name="modal">
                <div v-if="newmodulemodal" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto rounded-lg shadow bg-gray-700">
                            <button type="button" @click="newmodulemodal = false"
                                class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 v-if="editmodule" class="mb-4 text-xl font-medium text-gray-900 dark:text-white">
                                    Edit module</h3>
                                <h3 v-else class="mb-4 text-xl font-medium text-gray-900 dark:text-white">
                                    Register new module</h3>
                                <form id="newModuleForm" class="space-y-6" action="#" @submit.prevent="addmoduletodb">
                                    <div class="form-inner">
                                        <div>
                                            <label for="mysheet"
                                                class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Title</label>
                                            <input type="text" name="mymodule" id="mymodule"
                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white"
                                                placeholder="My first module" :value="[editmodule.title ? editmodule.title : '']" required>
                                            <input type="hidden" name="modulekey" :value="[editmodule.key ? editmodule.key : '']" />
                                        </div>
                                        <div class="form-inner-excs py-4">
                                            <label for="mysheet"
                                                class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">Exercises</label>
                                        </div>
                                        <div v-if="editmodule">
                                            <div class="flex" v-for="(modex, index) in editmodule.exs">
                                                <select v-model="modex.name" :name="'exec_'+index" class="exe-select border mb-3 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 bg-gray-600 border-gray-500 placeholder-gray-400 text-white mr-3">
                                                    <option v-for="exl in allexs" :value="exl.id">{{ exl.name }}</option>
                                                </select>
                                                <input type="number" :value="modex.reps" :name="'exec_'+index+'_reps'" class="border mb-3 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5 bg-gray-600 border-gray-500 placeholder-gray-400 text-white flex-1 w-24">
                                            </div>
                                            <a @click="appendinput(modalexec++)"
                                                class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-white bg-indigo-600 rounded-lg hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300">
                                                Add exercise
                                            </a>
                                        </div>
                                        <div v-else>
                                            <a @click="appendinput(modalexec++)"
                                                class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-white bg-indigo-600 rounded-lg hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300">
                                                Add exercise
                                            </a>
                                        </div>
                                    </div>
                                    <input type="hidden" name="action" :value="moduleformtype" />
                                    <button type="submit"
                                        class="w-full text-white bg-indigo-700 hover:bg-indigo-800 focus:ring-4 focus:outline-none focus:ring-indigo-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-indigo-600 dark:hover:bg-indigo-700 dark:focus:ring-indigo-800">Assign</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
        </div>
        <div class="lines-v1"></div>
        <div class="lines-v2"></div>
        <div class="lines-h1"></div>
        <div class="lines-h2"></div>
    </div>
    <svg width="0" height="0">
        <filter id='noise' x='0%' y='0%' width='100%' height='100%'>
            <feTurbulence type="fractalNoise" baseFrequency="0" result="NOISE" numOctaves="2" seed="0" />
            <feDisplacementMap in="SourceGraphic" in2="NOISE" scale="40" xChannelSelector="R" yChannelSelector="R">
            </feDisplacementMap>
        </filter>
    </svg>
</body>
<script>

    const { createApp } = Vue

    createApp({
        data() {
            return {
                db: [],
                data: [],
                mysheets: [],
                mymodules: [],
                allexs: [],
                currentPage: 'home',
                modal: '',
                assigning: null,
                goalform: null,
                modalexec: 0,
                moduleformtype: 'add',
                newsheetmodal: false,
                newmodulemodal: false, 
                editmodule: {}
            }
        },
        methods: {
            async setupData() {
                await axios
                    .get("data.json")
                    .then(response => {
                        this.data = response.data;
                    });

                this.db = await this.dbSetup()
                this.mysheets = await this.getsheets()
                this.mymodules = await this.getmodules();

                //extract all exercises
                this.data.plans.map(plan => {
                    plan.modules.map(module => {
                        module.exs.map(ex => {
                            this.allexs.push(ex)
                        })
                    })
                });

                [...document.querySelectorAll('.svg-filtered')].map(el => el.addEventListener('mouseover', () => { el.classList.add('filter-hover'); tl20.restart() }))

                if (window.location.search) {
                    searchParams = new URLSearchParams(window.location.search);
                    for (const [key, values] of searchParams.entries()) {
                        this.currentPage = values
                    }
                }

                setTimeout(() => {
                    document.getElementById('main').classList.remove('loading')
                }, 500);
            },
            async dbSetup() {
                return new Promise((resolve, reject) => {
                    let request = window.indexedDB.open("MyTestDatabase", 7);

                    request.onerror = event => {
                        reject('db not allowed')
                    };
                    request.onsuccess = event => {
                        resolve(event.target.result);
                    };

                    request.onupgradeneeded = event => {

                        let dbtoupgrade = event.target.result;
                        let objectStore

                        if (dbtoupgrade.objectStoreNames.contains('mysheets')) {
                            objectStore = event.target.transaction.objectStore("mysheets")
                            console.log('mysheets already exists, not recreating');
                        } else {
                            console.log('mysheets does not exist, creating');
                            objectStore = dbtoupgrade.createObjectStore("mysheets", { autoIncrement: true });
                        }

                        if (!objectStore.indexNames.contains("title")) objectStore.createIndex("title", "title", { unique: false });

                        if (dbtoupgrade.objectStoreNames.contains('mymodules')) {
                            objectStore = event.target.transaction.objectStore("mymodules")
                            console.log('mymodules already exists, not recreating');
                        } else {
                            console.log('mymodules does not exist, creating');
                            objectStore = dbtoupgrade.createObjectStore("mymodules", { autoIncrement: true });
                        }

                        if (!objectStore.indexNames.contains("title")) objectStore.createIndex("title", "title", { unique: false });
                    };
                })
            },
            async dbtojson(objstore){
                return new Promise((resolve, reject) => {
                    let values= []
                    let transaction = this.db.transaction([objstore], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(values);
                    };

                    let objectStore = transaction.objectStore(objstore);

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            values.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async exportdb(){
                let dbexport = {}
                if(this.db){

                    let dbsheets = await this.dbtojson('mysheets')
                    let dbmodules = await this.dbtojson('mymodules')
                    dbexport.mysheets = dbsheets
                    dbexport.mymodules = dbmodules

                    let a = document.createElement("a");
                    let jsonUrl = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(dbexport));
                    
                    document.body.appendChild(a);
                    
                    a.style = "display: none";
                    a.target = '_blank';
                    a.href = jsonUrl;
                    a.download = 'test.json';
                    a.click();
                    
                    document.body.removeChild(a);

                }
            },
            async importtodb(evt){
                const res = await this.parseJsonFile(evt.target.file.files[0])
                console.log(res)
                if(res){
                    res.mysheets.map( sheet => {

                        var transaction = this.db.transaction(["mysheets"], "readwrite");

                        transaction.oncomplete = event => {
                            console.log("All done!");
                        };

                        transaction.onerror = event => {};

                        var objectStore = transaction.objectStore("mysheets");
                        var request = objectStore.add(sheet);
                        request.onsuccess = event => {
                            console.log('import successfull')
                        };

                    } )
                    res.mymodules.map( module => {

                        var transaction = this.db.transaction(["mymodules"], "readwrite");

                        transaction.oncomplete = event => {
                            console.log("All done!");
                        };

                        transaction.onerror = event => {};

                        var objectStore = transaction.objectStore("mymodules");
                        var request = objectStore.add(module);
                        request.onsuccess = event => {
                            console.log('import successfull')
                        };

                    } )
                }

                this.mysheets = await this.getsheets()
            },
            async parseJsonFile(file) {
                return new Promise((resolve, reject) => {
                    const fileReader = new FileReader()
                    fileReader.onload = event => {

                        let filecontent = ''
                        if(event.target.result) {
                            try {
                                filecontent = JSON.parse(event.target.result);
                            } catch(e) {
                                console.log(e.message);
                            }
                        }
                        if(filecontent) resolve(filecontent)

                    }
                    fileReader.onerror = error => reject(error)
                    fileReader.readAsText(file)
                })
            },
            setCurrentPage(page) {
                this.currentPage = page
                //goal form close
                this.goalform = false
                if ('URLSearchParams' in window) {
                    searchParams = new URLSearchParams(window.location.search);
                    searchParams.set('page', page)
                    newRelativePathQuery = window.location.pathname + '?' + searchParams.toString();
                    history.pushState(null, '', newRelativePathQuery);
                }
            },
            assignmodule(module) {
                if (this.assigning == module) {
                    this.assigning = null
                } else {
                    this.assigning = module
                }
            },
            async assigntosheet(event) {
                let form = event.target

                let key = parseInt(form.sheet.value)
                let exindex = form.exindex.value
                let moduleindex = form.moduleindex.value
                let plantopush = this.data.plans[exindex].modules[moduleindex]

                if (this.db && key !== undefined) {

                    var transaction = this.db.transaction(["mysheets"], "readwrite")

                    transaction.oncomplete = event => {
                        console.log("All done!");
                    };

                    transaction.onerror = event => { };

                    var objectStore = transaction.objectStore("mysheets");
                    var request = objectStore.get(key);

                    request.onsuccess = event => {
                        //let titleKey = event.target.result.title
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === key) {
                                    const updateData = cursor.value;

                                    if (!updateData.assignedModules) {
                                        updateData.assignedModules = []
                                        updateData.assignedModules.push(JSON.stringify(plantopush))
                                    } else {
                                        updateData.assignedModules.push(JSON.stringify(plantopush))
                                    }

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('Success');
                                    };
                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.mysheets = await this.getsheets()

                }

            },
            async newSheet(event) {
                if (this.db && event.target && event.target.mysheet.value) {
                    var transaction = this.db.transaction(["mysheets"], "readwrite");

                    transaction.oncomplete = event => {
                        console.log("All done!");
                    };

                    transaction.onerror = event => { };

                    var objectStore = transaction.objectStore("mysheets");
                    var request = objectStore.add({ title: event.target.mysheet.value });
                    request.onsuccess = event => {
                        console.log('added successfull')
                    };

                    this.mysheets = await this.getsheets()
                }
            },
            async addmoduletodb(event) {
                if (this.db && event.target && event.target.mymodule.value) {
                    const transaction = this.db.transaction(["mymodules"], "readwrite");
                    const objectStore = transaction.objectStore('mymodules');

                    transaction.oncomplete = event => {
                        console.log("All done!");
                    };

                    transaction.onerror = event => { };

                    let moduletitle = event.target.mymodule.value
                    let modulekey = event.target.modulekey.value
                    let excslist = [];
                    [...event.target.elements].map(el => { if (el.classList.contains('exe-select')) excslist.push({ name: el.value, reps: document.getElementsByName(el.name + '_reps')[0].value }) });

                    console.log(event.target.action.value)
                    if (event.target.action.value == 'edit') {

                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key == modulekey && cursor.value.exs) {
                                    const updateData = cursor.value;

                                    updateData.exs = excslist

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('Success');
                                    };

                                }
                                cursor.continue();
                            }
                        }

                    } else {

                        var request = objectStore.add({ title: moduletitle, exs: excslist });
                        request.onsuccess = event => {
                            console.log('added successfull')
                        };

                    }

                    this.mymodules = await this.getmodules()
                }
            },
            async removefromdb(key, trans) {
                if (this.db && key !== undefined) {

                    var transaction = this.db.transaction([trans], "readwrite")

                    transaction.oncomplete = event => {
                        console.log("All done!");
                    };

                    transaction.onerror = event => { };

                    var objectStore = transaction.objectStore(trans);

                    //key start from 1 in db
                    var request = objectStore.delete(key);

                    request.onsuccess = event => {
                        console.log('removed successfull')
                    };

                    request.onerror = event => {
                        console.log('error!!')
                    };

                    this.mysheets = await this.getsheets()
                    this.mymodules = await this.getmodules()

                }
            },
            async getsheets() {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['mysheets'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(sheets);
                    };

                    let objectStore = transaction.objectStore('mysheets');
                    let sheets = [];

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            cursor.value.key = cursor.key

                            //modules saved as string -> convert in json object
                            if (cursor.value.assignedModules) {
                                let buildmodules = []
                                cursor.value.assignedModules.map(module => buildmodules.push(JSON.parse(module)))
                                cursor.value.assignedModules = buildmodules
                            }

                            sheets.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async getmodules() {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['mymodules'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(sheets);
                    };

                    let objectStore = transaction.objectStore('mymodules');
                    let sheets = [];

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            cursor.value.key = cursor.key

                            sheets.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async displayDataByIndex() {
                const transaction = this.db.transaction(['mysheets'], 'readonly');
                const objectStore = transaction.objectStore('mysheets');

                const myIndex = objectStore.index('lName');
                myIndex.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        console.log(cursor.value)

                        cursor.continue();
                    } else {
                        console.log('Entries all displayed.');
                    }
                };
            },
            async newgoalform() {
                if (!this.goalform)
                    this.goalform = true
                else
                    this.goalform = false
            },
            async assigngoaltosheet() {
                let form = event.target

                let key = parseInt(form.key.value)
                let title = form.goal_title.value
                let message = form.motivation_message.value

                if (this.db && key !== undefined) {

                    var transaction = this.db.transaction(["mysheets"], "readwrite")

                    transaction.oncomplete = event => {
                        console.log("All done!");
                    };

                    transaction.onerror = event => { };

                    var objectStore = transaction.objectStore("mysheets");
                    var request = objectStore.get(key);

                    request.onsuccess = event => {
                        //let titleKey = event.target.result.title
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === key) {
                                    const updateData = cursor.value;

                                    if (!updateData.goals) {
                                        updateData.goals = []
                                        updateData.goals.push({ title: title, message: message, reached: false })
                                    } else {
                                        updateData.goals.push({ title: title, message: message, reached: false })
                                    }

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('Success');
                                    };
                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.mysheets = await this.getsheets()

                }
            },
            async deletemodule(sheetkey, modulekey) {
                const transaction = this.db.transaction(['mysheets'], 'readwrite');
                const objectStore = transaction.objectStore('mysheets');

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.assignedModules) {
                            const updateData = cursor.value;

                            let moduleindex = null
                            updateData.assignedModules.map((module, index) => module.key == modulekey ? moduleindex = index : '')

                            //do the things
                            updateData.assignedModules.splice(moduleindex, 1);

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            async deletegoal(sheetkey, goalkey) {
                const transaction = this.db.transaction(['mysheets'], 'readwrite');
                const objectStore = transaction.objectStore('mysheets');

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.goals) {
                            const updateData = cursor.value;

                            let goalindex = null
                            updateData.goals.map((goal, index) => goal.title == goalkey ? goalindex = index : '')

                            //do the things
                            updateData.goals.splice(goalindex, 1);

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            async setgoalreached(sheetkey, goalkey) {
                const transaction = this.db.transaction(['mysheets'], 'readwrite');
                const objectStore = transaction.objectStore('mysheets');

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.goals) {
                            const updateData = cursor.value;

                            let goalindex = null
                            updateData.goals.map((goal, index) => goal.title == goalkey ? goalindex = index : '')

                            //do the things
                            updateData.goals[goalindex].reached = true;

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            appendinput(count) {

                //count edit fix
                if(this.editmodule.exs){
                    if(this.editmodule.exs.length){
                        count += this.editmodule.exs.length
                    }
                }
                
                let row = document.createElement('div')
                row.classList.add('flex')

                let input = document.createElement('select')
                //input.setAttribute('type', 'text')
                //input.setAttribute('value', '')
                //input.setAttribute('placeholder', 'Exercise')
                input.setAttribute('name', 'exec_' + count)
                input.classList.add('exe-select', 'border', 'mb-3', 'text-sm', 'rounded-lg', 'focus:ring-indigo-500', 'focus:border-indigo-500', 'block', 'w-full', 'p-2.5', 'bg-gray-600', 'border-gray-500', 'placeholder-gray-400', 'text-white', 'mr-3')

                let temp = document.createElement('option')
                temp.setAttribute('value', '')
                temp.textContent = '---'
                input.append(temp)

                this.allexs.map( ex => {
                    temp = document.createElement('option')
                    temp.setAttribute('value', ex.id)
                    temp.textContent = ex.name
                    input.append(temp)
                } )

                let reps = document.createElement('input')
                reps.setAttribute('type', 'number')
                reps.setAttribute('value', '5')
                reps.setAttribute('name', 'exec_' + count + '_reps')
                reps.classList.add('border', 'mb-3', 'text-sm', 'rounded-lg', 'focus:ring-indigo-500', 'focus:border-indigo-500', 'block', 'w-full', 'p-2.5', 'bg-gray-600', 'border-gray-500', 'placeholder-gray-400', 'text-white', 'flex-1', 'w-24')

                row.append(input)
                row.append(reps)

                document.querySelector('#newModuleForm .form-inner-excs').append(row)
            }
        },
        mounted() {
            this.setupData()
        }
    }).mount('#app')

    //svg filter animation
    const tl20 = gsap.timeline();
    let primitiveValues = { turbulence: 0 };
    let filterid = document.querySelector('#noise > feTurbulence');

    tl20.to(primitiveValues, {
        duration: .35,
        ease: 'power4',
        startAt: { turbulence: [0, 0] },
        turbulence: [0.001, 1],
        onUpdate: () => {
            filterid.setAttribute('baseFrequency', primitiveValues.turbulence)
        },
        onComplete: () => {
            filterid.setAttribute('baseFrequency', [0, 0]);
            [...document.querySelectorAll('.filter-hover')].map(el => el.classList.remove('filter-hover'))
        }
    });
</script>

</html>