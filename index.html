<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>RUPE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/flowbite@1.4.7/dist/flowbite.min.css" />
    <script src="https://unpkg.com/vue@3"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600&family=Saira+Semi+Condensed:wght@200;400;700&family=Teko:wght@500&display=swap"
        rel="stylesheet">
    <script>
        if (!window.indexedDB) {
            console.log("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");
        }
    </script>
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        * {
            margin: 0;
        }

        html,
        body {
            height: 100%;
        }

        body {
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        img,
        picture,
        video,
        canvas,
        svg {
            display: block;
            max-width: 100%;
        }

        input,
        button,
        textarea,
        select {
            font: inherit;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Saira Semi Condensed', sans-serif;
            font-weight: 600;
            overflow-wrap: break-word;
        }

        p,
        li {
            font-family: 'Rajdhani', sans-serif;
        }

        .logo {
            font-family: 'Teko', sans-serif;
            font-weight: 500;
        }

        a,
        button,
        input,
        optgroup,
        select,
        textarea {
            font-family: 'Saira Semi Condensed', sans-serif !important;
        }

        a {
            cursor: pointer;
        }

        #app {
            position: relative;
        }

        .v-enter-active,
        .v-enter-from {
            transition-delay: .25s !important;
        }

        .v-enter-active,
        .v-leave-active {
            transition: opacity 0.25s ease;
        }

        .v-enter-from,
        .v-leave-to {
            opacity: 0;
        }

        .loading {
            opacity: 0;
        }

        h1,
        .text-sand,
        ul li a:hover {
            color: #000 !important;
        }

        .bg-sand {
            /*background-color: #ffcb00!important;*/
            background-color: #dfff45 !important;
        }

        .min-w-25 {
            min-width: calc(25% - 1rem);
        }

        .list-square {
            list-style: inside square !important;
        }

        .modal-mask {
            position: fixed;
            z-index: 9998;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: table;
            transition: opacity 0.3s ease;
        }

        .modal-wrapper {
            display: table-cell;
            vertical-align: middle;
        }

        .modal-container {
            margin: 0px auto;
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.33);
            transition: all 0.3s ease;
        }

        .modal-enter-from {
            opacity: 0;
        }

        .modal-leave-to {
            opacity: 0;
        }

        .modal-enter-from .modal-container,
        .modal-leave-to .modal-container {
            -webkit-transform: scale(1.1);
            transform: scale(1.1);
        }

        ul li a:hover {
            transition: .3s ease-out;
        }
    </style>
</head>

<body>

    <div id="app">
        <div class="bg-white text-gray-content px-4">
            <div id="main" class="min-h-screen relative z-10 loading">
                <nav class="px-2 sm:px-4 py-2.5">
                    <div class="container flex flex-wrap justify-between items-center mx-auto">
                        <a class="flex items-center">
                            <span class="text-black self-center text-3xl whitespace-nowrap logo">RUPE</span>
                        </a>
                        <div class="flex md:order-2">
                            <button type="button" @click="newsheetmodal = true"
                                class="bg-sand text-black focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg"
                                type="button">
                                <svg class="w-4 h-4 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Get started
                            </button>
                            <button data-collapse-toggle="mobile-menu" type="button"
                                @click="mobilemenuopen ? mobilemenuopen = false : mobilemenuopen = true"
                                class="inline-flex items-center p-2 text-sm text-gray-600 md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 h-10"
                                aria-controls="mobile-menu" aria-expanded="false">
                                <span class="sr-only">Open main menu</span>
                                <svg :class="[mobilemenuopen ? 'hidden' : '']" class="w-6 h-6 menu-responsive-show"
                                    fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                        clip-rule="evenodd"></path>
                                </svg>
                                <svg :class="[!mobilemenuopen ? 'hidden' : '']" class="w-6 h-6" fill="currentColor"
                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                        </div>
                        <div :class="[!mobilemenuopen ? 'hidden' : '']"
                            class="justify-between items-center w-full md:flex md:w-auto md:order-1" id="mobile-menu">
                            <ul class="flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium">
                                <li>
                                    <a @click="setCurrentPage('home', 'page')"
                                        class="block text-lg py-2 pr-4 pl-3 text-black" aria-current="page">Home</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('about', 'page')"
                                        class="block text-lg py-2 pr-4 pl-3 text-black">About</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('rupe-modules', 'page')"
                                        class="block text-lg py-2 pr-4 pl-3 text-black">RUPE
                                        modules</a>
                                </li>
                                <li>
                                    <a @click="setCurrentPage('my-programs', 'page')"
                                        class="block text-lg py-2 pr-4 pl-3 text-black">My
                                        sheets</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>

                <!-- Content -->
                <div class="container mx-auto py-8 min-h-screen">
                    <Transition>
                        <div class="pb-12 relative" v-if="currentPage == 'home'">
                            <section>
                                <div class="py-12">
                                    <h1 id="main-heading"
                                        class="mb-4 text-4xl font-bold tracking-tight leading-none md:text-5xl lg:text-6xl text-black">
                                        Get your Workouts done</h1>
                                    <p class="mb-8 text-lg font-normal text-gray-600 max-w-xl lg:text-xl">
                                        RUPE helps you planning your workout, create your custom training program or
                                        choose between predefined modules, work hard and reach your goals</p>
                                    <div
                                        class="flex flex-col mb-8 lg:mb-16 space-y-4 sm:flex-row sm:justify-start sm:space-y-0 sm:space-x-4">
                                        <a href="#"
                                            class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-black bg-gray-100 shadow-lg hover:bg-gray-300 focus:ring-4 focus:ring-gray-100">
                                            How it works
                                            <svg class="ml-2 -mr-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd"
                                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                    clip-rule="evenodd"></path>
                                            </svg>
                                        </a>
                                        <button
                                            class="relative inline-flex items-center justify-center bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg">
                                            <svg class="inline-block mr-2 -ml-1 w-5 h-5" fill="none"
                                                stroke="currentColor" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                                </path>
                                            </svg>
                                            My sheets
                                        </button>
                                    </div>
                                </div>
                            </section>

                            <div class="my-8 mb-16">
                                <h2 class="text-black mb-4 text-2xl font-bold lg:text-3xl">
                                    <svg class="w-8 h-8 inline-block" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                        </path>
                                    </svg>&nbsp;My sheets
                                </h2>
                                <p class="text-gray-600 mb-6">
                                    Create your sheet and assign modules to build your custom training program
                                </p>
                                <div class="my-4 flex gap-4 flex-wrap">
                                    <div v-if="mysheets.length" v-for="sheet in mysheets" class="min-w-25">
                                        <div
                                            class="p-6 max-w-sm border shadow-md border-gray-400 bg-gray-200 text-gray-600">
                                            <a @click="setCurrentPage(sheet.key, 'sheet')" class="block">
                                                <h5
                                                    class="text-2xl font-normal capitalize tracking-tight text-gray-900 inline-block mb-3 text-sand">
                                                    {{sheet.title}}</h5>
                                                <div class="pt-2">
                                                    <p class="mb-2 font-bold">Assigned modules:</p>
                                                    <ul v-if="sheet.assignedModules && sheet.assignedModules.length"
                                                        class="list-square">
                                                        <li class="font-medium" v-for="module in sheet.assignedModules">
                                                            {{module}}</li>
                                                    </ul>
                                                    <p class="text-black" v-else>No modules assigned yet</p>
                                                </div>
                                            </a>
                                            <div class="mt-5 pt-2 border-t border-gray-500">
                                                <span @click="removefromdb(sheet.key, 'mysheets')"
                                                    class="cursor-pointer inline-flex items-center mt-2 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Delete</span>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-sand" v-else>No sheets created yet</p>
                                </div>
                                <div class="my-5">
                                    <button type="button" @click="newsheetmodal = true"
                                        class="bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg"
                                        type="button">
                                        <svg class="w-4 h-4 inline-block" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        Add new sheet
                                    </button>
                                </div>
                            </div>
                            <div class="my-8 mb-16">
                                <h2 class="text-black mb-4 text-2xl font-bold lg:text-3xl">
                                    <svg class="w-8 h-8 inline-block" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z">
                                        </path>
                                    </svg>&nbsp;My modules
                                </h2>
                                <p class="text-gray-600 mb-6">
                                    Create your modules to group some specific exercises and assign them to your sheet,
                                    or go to RUPE modules
                                </p>
                                <div class="flex gap-4 flex-wrap" v-if="mymodules.length">
                                    <div class="p-6 h-full max-w-sm bg-gray-100 border border-gray-400 shadow-md"
                                        v-for="(module, moduleindex) in mymodules">
                                        <a href="#">
                                            <h5 class="mb-4 text-2xl font-medium tracking-tight text-sand">
                                                {{module.title}}</h5>
                                        </a>
                                        <p class="mb-3 font-normal text-sand">
                                            {{module.description}}
                                        <ul>
                                            <li v-for="ex in module.exs" class="mb-3 font-normal text-gray-500">
                                                <strong class="text-lg text-gray-800">{{ allexs.find( el => el.id ==
                                                    ex.id ).name }}</strong>
                                                <p class="text-lg">{{ allexs.find( el => el.id == ex.id ).description }}
                                                </p>
                                                <p class="text-lg font-bold">Reps:&nbsp;<strong
                                                        class="text-gray-800">x{{ ex.reps }}</strong></p>
                                            </li>
                                        </ul>
                                        </p>
                                        <button v-if="mysheets.length" @click="assignmodule(module.title)"
                                            class="w-full my-5 relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium group hover:text-black text-black focus:ring-4 focus:outline-none focus:ring-gray-200 shadow-lg bg-sand">
                                            <span
                                                class="w-full relative px-5 py-2.5 transition-all ease-in duration-75 text-gray-800">
                                                Add to sheet
                                                <svg class="inline-block ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd"
                                                        d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                        clip-rule="evenodd"></path>
                                                </svg>
                                            </span>
                                        </button>
                                        <p class="pt-4 text-sand" v-else>Get started by creating your first sheet</p>
                                        <form v-if="assigning == module.title" class="my-6 space-y-6" action="#"
                                            @submit.prevent="assigntosheet">
                                            <div>
                                                <label for="mysheets"
                                                    class="block mb-2 text-sm font-medium text-gray-600">Sheets</label>
                                                <select name="sheet"
                                                    class="border text-sm block w-full p-2.5 bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500">
                                                    <option v-for="(sheet, index) in mysheets" :value="sheet.key">
                                                        {{sheet.title}}</option>
                                                </select>
                                                <!--<input type="hidden" name="exindex" :value="exindex" />-->
                                                <input type="hidden" name="moduleindex" :value="module.key" />
                                            </div>
                                            <button type="submit"
                                                class="w-full text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-400 hover:bg-gray-300 focus:ring-gray-200">Add</button>
                                        </form>
                                        <button
                                            @click="moduleformtype = 'edit'; newmodulemodal = true; editmodule = JSON.parse(JSON.stringify(module))"
                                            type="button"
                                            class="cursor-pointer inline-flex items-center mt-5 mr-2 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300"
                                            type="button">Edit module</button>
                                        <span @click="removefromdb(module.key, 'mymodules')"
                                            class="cursor-pointer inline-flex items-center mt-5 mr-2 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Delete</span>
                                    </div>
                                </div>
                                <div v-else>
                                    <p class="text-sand">No modules created yet</p>
                                </div>
                                <div class="my-5">
                                    <button type="button"
                                        @click="moduleformtype = 'add'; newmodulemodal = true; editmodule = {}"
                                        class="bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg"
                                        type="button">
                                        <svg class="w-4 h-4 inline-block" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                        Add new module
                                    </button>
                                </div>
                            </div>
                            <div class="my-8">
                                <h2 class="text-black mb-4 text-2xl font-bold lg:text-3xl">
                                    <svg class="w-8 h-8 inline-block" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4">
                                        </path>
                                    </svg>&nbsp;Import / export data
                                </h2>
                                <p class="text-gray-600 mb-6">
                                    Import/export your training programs for browser/device data transfer or share them
                                    with your friends
                                </p>
                                <div>
                                    <form class="my-6 space-y-6" @submit.prevent="importtodb">
                                        <label class="block">
                                            <span class="sr-only">Data file</span>
                                            <input type="file" name="file" class="block w-full text-sm text-gray-500
                                              file:mr-4 file:py-2 file:px-4 file:border-0
                                              file:text-sm file:font-semibold
                                              file:bg-gray-50 file:text-gray-600
                                              hover:file:bg-gray-100
                                            " />
                                        </label>
                                        <button type="submit"
                                            class="bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg">Import</button>
                                    </form>
                                </div>
                                <div v-if="mysheets.length">
                                    <div class="my-3">
                                        <button type="button" @click="exportdb"
                                            class="bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg"
                                            type="button">Export data</button>
                                    </div>
                                </div>
                                <p class="text-sand" v-else>No sheets created yet</p>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'about'">
                            <div class="container mx-auto py-8">
                                <h2 class="text-black mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                    about
                                </h2>
                                <p class="text-gray-500">
                                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    incididunt ut labore et dolore magna aliqua.
                                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
                                    ex ea commodo consequat.
                                    Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
                                    fugiat nulla pariatur.
                                    Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
                                    mollit anim id est laborum</p>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'my-programs'">
                            <div class="container mx-auto py-8">
                                <h2 class="text-black mb-4 text-2xl font-bold lg:text-3xl">
                                    <svg class="w-8 h-8 inline-block" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                        </path>
                                    </svg>&nbsp;My sheets
                                </h2>
                                <div class="my-4 flex gap-4 flex-wrap">
                                    <div v-if="mysheets.length" v-for="sheet in mysheets" class="min-w-25">
                                        <div
                                            class="p-6 max-w-sm border shadow-md border-gray-400 bg-gray-200 text-gray-600">
                                            <a @click="setCurrentPage(sheet.key, 'sheet')" class="block">
                                                <h5
                                                    class="text-2xl font-normal capitalize tracking-tight text-gray-900 inline-block mb-3 text-sand">
                                                    {{sheet.title}}</h5>
                                                <div class="pt-2">
                                                    <p class="mb-2 font-bold">Assigned modules:</p>
                                                    <ul v-if="sheet.assignedModules && sheet.assignedModules.length"
                                                        class="list-square">
                                                        <li class="font-medium" v-for="module in sheet.assignedModules">
                                                            {{module}}</li>
                                                    </ul>
                                                    <p class="text-black" v-else>No modules assigned yet</p>
                                                </div>
                                            </a>
                                            <div class="mt-5 pt-2 border-t border-gray-500">
                                                <span @click="removefromdb(sheet.key, 'mysheets')"
                                                    class="cursor-pointer inline-flex items-center mt-2 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Delete</span>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-sand" v-else>No sheets created yet</p>
                                </div>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else-if="currentPage == 'rupe-modules'">
                            <div>
                                <div class="" v-for="(element, exindex) in data.plans">
                                    <div class="my-8">
                                        <h2 class="text-black mb-2 text-2xl font-bold lg:text-3xl md:mb-2">
                                            {{element.title}}
                                        </h2>
                                        <p class="mx-auto text-gray-500 md:text-lg">
                                            {{element.description}}
                                        </p>
                                    </div>
                                    <div class="flex gap-4 flex-wrap">
                                        <div class="p-6 h-full max-w-sm bg-gray-100 border border-gray-400 shadow-md"
                                            v-for="(module, moduleindex) in element.modules">
                                            <a href="#">
                                                <h5 class="mb-4 text-2xl font-medium tracking-tight text-sand">
                                                    {{module.title}}</h5>
                                            </a>
                                            <p class="mb-3 font-normal text-sand">
                                                {{module.description}}
                                            <ul>
                                                <li v-for="ex in module.exs" class="mb-3 font-normal text-gray-500">
                                                    <strong class="text-lg text-gray-800">{{ ex.name }}</strong>
                                                    <p class="text-lg">{{ ex.description }}</p>
                                                    <p class="text-lg font-bold">Reps:&nbsp;<strong
                                                            class="text-gray-800">{{ ex.reps }}</strong></p>
                                                </li>
                                            </ul>
                                            </p>
                                            <button v-if="mysheets.length" @click="assignmodule(module.title)"
                                                class="w-full my-5 relative inline-flex items-center justify-center p-0.5 mb-2 mr-2 overflow-hidden text-sm font-medium group hover:text-black text-black focus:ring-4 focus:outline-none focus:ring-gray-200 shadow-lg bg-sand">
                                                <span
                                                    class="w-full relative px-5 py-2.5 transition-all ease-in duration-75 text-gray-800">
                                                    Add to sheet
                                                    <svg class="inline-block ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd"
                                                            d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                            clip-rule="evenodd"></path>
                                                    </svg>
                                                </span>
                                            </button>
                                            <p class="pt-4 text-sand" v-else>Get started by creating your first sheet
                                            </p>
                                            <form v-if="assigning == module.title" class="my-6 space-y-6" action="#"
                                                @submit.prevent="assigntosheet">
                                                <div>
                                                    <label for="mysheets"
                                                        class="block mb-2 text-sm font-medium text-gray-600">Sheets</label>
                                                    <select name="sheet"
                                                        class="border text-sm block w-full p-2.5 bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500">
                                                        <option v-for="(sheet, index) in mysheets" :value="sheet.key">
                                                            {{sheet.title}}</option>
                                                    </select>
                                                    <input type="hidden" name="exindex" :value="exindex" />
                                                    <input type="hidden" name="moduleindex" :value="moduleindex" />
                                                </div>
                                                <button type="submit"
                                                    class="w-full text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-400 hover:bg-gray-300 focus:ring-gray-200">Add</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="pb-12 relative" v-else>
                            <div v-for="sheet in mysheets">
                                <div v-if="currentPage == sheet.key">
                                    <div class="container mx-auto py-8">
                                        <h2 class="text-black mb-8 text-2xl font-bold lg:text-4xl">
                                            {{sheet.title}}
                                        </h2>
                                        <div>
                                            <div v-if="sheet.assignedModules && sheet.assignedModules.length">
                                                <div class="">
                                                    <div class="mb-6">
                                                        <div class="pt-8">
                                                            <h3 class="text-black mb-6 text-2xl font-bold lg:text-2xl">
                                                                <svg class="w-6 h-6 inline-block" fill="none"
                                                                    stroke="currentColor" viewBox="0 0 24 24"
                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                                        stroke-width="2"
                                                                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                                                    </path>
                                                                </svg>
                                                                Week schedule
                                                            </h3>
                                                        </div>
                                                        <div v-if="myplans.filter( plan => plan.sheet == sheet.title ).length"
                                                            class="overflow-x-auto relative shadow-md">
                                                            <table class="w-full text-sm text-left text-gray-500">
                                                                <thead
                                                                    class="text-xs uppercase bg-gray-300 text-gray-500">
                                                                    <tr>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Monday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Tuesday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Wednesday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Thursday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Friday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Saturday
                                                                        </th>
                                                                        <th scope="col" class="py-3 px-6">
                                                                            Sunday
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="border-b bg-gray-100 border-gray-300">
                                                                        <td :class="[currentDay == 1 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('1') || plan.weekdays[0].includes('1') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 2 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('2') || plan.weekdays[0].includes('2') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 3 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('3') || plan.weekdays[0].includes('3') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 4 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('4') || plan.weekdays[0].includes('4') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 5 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('5') || plan.weekdays[0].includes('5') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 6 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('6') || plan.weekdays[0].includes('6') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                        <td :class="[currentDay == 0 ? 'bg-sand text-gray-900 font-bold' : '']"
                                                                            class="py-4 px-6">
                                                                            <ul>
                                                                                <li
                                                                                    v-for="plan in myplans.filter( plan => plan.sheet == sheet.title && (plan.weekdays[weekType].includes('0') || plan.weekdays[0].includes('0') && !plan.weekdays[1].length) )">
                                                                                    {{plan.title}}</li>
                                                                            </ul>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div v-else>
                                                            <p class="pt-4 text-gray-800">No workouts added yet</p>
                                                        </div>
                                                    </div>
                                                    <div class="mb-6">
                                                        <div class="pt-8">
                                                            <h3 class="text-black mb-6 text-2xl font-bold lg:text-2xl">
                                                                <svg class="w-6 h-6 inline-block" fill="none"
                                                                    stroke="currentColor" viewBox="0 0 24 24"
                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                                        stroke-width="2"
                                                                        d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z">
                                                                    </path>
                                                                </svg>
                                                                My workouts
                                                            </h3>
                                                        </div>
                                                        <div v-if="myplans"
                                                            class="bg-gray-100 max-w-6xl mb-6 border border-gray-400 shadow-lg"
                                                            v-for="plan in myplans.filter( plan => plan.sheet == sheet.title )">
                                                            <div>
                                                                <div class="p-4 mb-2 flex justify-between bg-gray-200">
                                                                    <div>
                                                                        <form v-if="plantitleedit == plan.key"
                                                                            @submit.prevent="planRenameForm">
                                                                            <input type="text" id="plantitle_edit"
                                                                                name="plantitle_edit"
                                                                                class="text-md text-gray-900 block inline mr-1 p-2.5 bg-gray-200 placeholder-gray-400 focus:ring-gray-500 focus:border-gray-500"
                                                                                :value="plan.title"
                                                                                :placeholder="plan.title">
                                                                            <input type="hidden" name="plan"
                                                                                :value="plan.key" />
                                                                            <input type="submit"
                                                                                class="inline text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-200 hover:bg-gray-300 focus:ring-gray-200"
                                                                                value="confirm">
                                                                        </form>
                                                                        <h5 class="text-xl font-bold text-gray-900"
                                                                            v-else>
                                                                            <button @click="plantitleedit = plan.key">
                                                                                <svg class="w-6 h-6 inline" fill="none"
                                                                                    stroke="currentColor"
                                                                                    viewBox="0 0 24 24"
                                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                                    <path stroke-linecap="round"
                                                                                        stroke-linejoin="round"
                                                                                        stroke-width="2"
                                                                                        d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z">
                                                                                    </path>
                                                                                </svg>
                                                                            </button>
                                                                            {{plan.title}}
                                                                        </h5>
                                                                    </div>
                                                                    <button @click="cleanresume(plan)">
                                                                        <svg class="w-6 h-6 px-3 py-2 bg-gray-200 box-content"
                                                                            fill="none" stroke="currentColor"
                                                                            viewBox="0 0 24 24"
                                                                            xmlns="http://www.w3.org/2000/svg">
                                                                            <path stroke-linecap="round"
                                                                                stroke-linejoin="round" stroke-width="2"
                                                                                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
                                                                            </path>
                                                                            <path stroke-linecap="round"
                                                                                stroke-linejoin="round" stroke-width="2"
                                                                                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
                                                                            </path>
                                                                        </svg>
                                                                    </button>
                                                                </div>
                                                                <div class="p-4">
                                                                    <div v-if="plan.exs">
                                                                        <ul>
                                                                            <li class="my-2 pb-2"
                                                                                v-for="(ex, index) in plan.exs">
                                                                                <div class="flex justify-between gap-4">
                                                                                    <div class="flex flex-col justify-evenly">
                                                                                        <button
                                                                                            @click="planmoveex(plan.key, index, 'up', sheet.title)">
                                                                                            <svg class="w-6 h-6" fill="none"
                                                                                                stroke="currentColor"
                                                                                                viewBox="0 0 24 24"
                                                                                                xmlns="http://www.w3.org/2000/svg">
                                                                                                <path stroke-linecap="round"
                                                                                                    stroke-linejoin="round"
                                                                                                    stroke-width="2"
                                                                                                    d="M5 15l7-7 7 7"></path>
                                                                                            </svg>
                                                                                        </button>
                                                                                        <button
                                                                                            @click="planmoveex(plan.key, index, 'down', sheet.title)">
                                                                                            <svg class="w-6 h-6" fill="none"
                                                                                                stroke="currentColor"
                                                                                                viewBox="0 0 24 24"
                                                                                                xmlns="http://www.w3.org/2000/svg">
                                                                                                <path stroke-linecap="round"
                                                                                                    stroke-linejoin="round"
                                                                                                    stroke-width="2"
                                                                                                    d="M19 9l-7 7-7-7"></path>
                                                                                            </svg>
                                                                                        </button>
                                                                                    </div>
                                                                                    <div class="flex-1" v-if="ex.id">
                                                                                        <strong class="font-bold text-xl">{{
                                                                                            allexs.find( el => el.id == ex.id
                                                                                            ).name }}</strong>
                                                                                        <p class="text-lg">{{ allexs.find( el =>
                                                                                            el.id == ex.id ).description }}</p>
                                                                                        <p class="text-lg">
                                                                                            Reps:&nbsp;<strong
                                                                                                class="font-bold">{{ ex.reps
                                                                                                }}</strong></p>
                                                                                    </div>
                                                                                    <div>
                                                                                        <button
                                                                                            @click="sheetplanexremove(index, plan.key)"
                                                                                            class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">remove</button>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="mt-6 p-4 border-t border-b border-gray-400">
                                                                                    <div v-if="plan.rests.find( el => el.exi == index )" class="text-xl mb-4">
                                                                                        Rest: <span class="font-bold">{{ plan.rests.find( el => el.exi == index ).rest }}</span>
                                                                                    </div>
                                                                                    <div class="flex items-center">
                                                                                        <input :id="'restcheck'+plan.key"
                                                                                            :name="'restcheck'+plan.key" type="radio"
                                                                                            :value="index"
                                                                                            class="w-4 h-4 text-gray-500 bg-gray-100 rounded border-gray-300 focus:ring-gray-500 dark:focus:ring-gray-400 dark:ring-offset-gray-200 focus:ring-2 dark:bg-gray-300 dark:border-gray-400"
                                                                                            @change="setexrest">
                                                                                        <label :for="'restcheck'+plan.key"
                                                                                            class="ml-2 text-sm font-medium text-gray-900"><span v-if="plan.rests.find( el => el.exi == index )">Change</span><span v-else>Set</span> rest</label>
                                                                                    </div>
                                                                                    <form v-if="exrest && exrest == index" class="space-y-2" @submit.prevent="sheetplanaddrest">
                                                                                        <input type="number" name="rest" placeholder="Rest" class="mr-2 border text-sm block inline p-1 bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500" />
                                                                                        <input type="hidden" name="ex"
                                                                                            :value="index" />
                                                                                        <input type="hidden" name="plan"
                                                                                            :value="plan.key" />
                                                                                        <input type="submit"
                                                                                            class="inline text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-1.5 text-center bg-gray-200 hover:bg-gray-300 focus:ring-gray-200"
                                                                                            value="confirm">
                                                                                    </form>
                                                                                </div>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <div v-else>
                                                                        <p class="pt-4 text-gray-800">No exercises added yet
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="mb-8 p-4">
                                                                <form class="space-y-4" action="#"
                                                                    @submit.prevent="setplanweekdays">
                                                                    <h3 class="mb-4 font-semibold text-gray-900">
                                                                        Set weekdays
                                                                    </h3>
                                                                    <p
                                                                        v-if="altw == plan.key || plan.weekdays[1].length">
                                                                        Week even</p>
                                                                    <ul
                                                                        class="items-center w-full text-sm font-medium border sm:flex bg-gray-300 border-gray-400 text-black">
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'monday'+plan.key"
                                                                                    type="checkbox" value="1"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('1')">
                                                                                <label :for="'monday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Monday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'tuesday'+plan.key"
                                                                                    type="checkbox" value="2"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('2')">
                                                                                <label :for="'tuesday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Tuesday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'wednesday'+plan.key"
                                                                                    type="checkbox" value="3"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('3')">
                                                                                <label :for="'wednesday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Wednesday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'thursday'+plan.key"
                                                                                    type="checkbox" value="4"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('4')">
                                                                                <label :for="'thursday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Thursday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'friday'+plan.key"
                                                                                    type="checkbox" value="5"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('5')">
                                                                                <label :for="'friday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Friday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'saturday'+plan.key"
                                                                                    type="checkbox" value="6"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('6')">
                                                                                <label :for="'saturday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Saturday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li class="w-full border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'sunday'+plan.key"
                                                                                    type="checkbox" value="0"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[0].includes('0')">
                                                                                <label :for="'sunday'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Sunday</label>
                                                                            </div>
                                                                        </li>
                                                                    </ul>
                                                                    <p
                                                                        v-if="altw == plan.key || plan.weekdays[1].length">
                                                                        Week odd</p>
                                                                    <ul v-if="altw == plan.key || plan.weekdays[1].length"
                                                                        class="items-center w-full text-sm font-medium border sm:flex bg-gray-300 border-gray-400 text-black">
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'monday_alt'+plan.key"
                                                                                    type="checkbox" value="1"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('1')">
                                                                                <label :for="'monday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Monday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'tuesday_alt'+plan.key"
                                                                                    type="checkbox" value="2"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('2')">
                                                                                <label :for="'tuesday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Tuesday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'wednesday_alt'+plan.key"
                                                                                    type="checkbox" value="3"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('3')">
                                                                                <label :for="'wednesday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Wednesday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'thursday_alt'+plan.key"
                                                                                    type="checkbox" value="4"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('4')">
                                                                                <label :for="'thursday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Thursday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'friday_alt'+plan.key"
                                                                                    type="checkbox" value="5"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('5')">
                                                                                <label :for="'friday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Friday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li
                                                                            class="w-full border-b sm:border-b-0 sm:border-r border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'saturday_alt'+plan.key"
                                                                                    type="checkbox" value="6"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('6')">
                                                                                <label :for="'saturday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Saturday</label>
                                                                            </div>
                                                                        </li>
                                                                        <li class="w-full border-gray-400">
                                                                            <div class="flex items-center pl-3">
                                                                                <input :id="'sunday_alt'+plan.key"
                                                                                    type="checkbox" value="0"
                                                                                    class="w-4 h-4 text-gray-500 focus:ring-gray-400 ring-offset-gray-300 focus:ring-2 bg-gray-400 border-gray-500"
                                                                                    :checked="plan.weekdays[1].includes('0')">
                                                                                <label :for="'sunday_alt'+plan.key"
                                                                                    class="py-3 ml-2 w-full text-sm font-medium text-gray-600">Sunday</label>
                                                                            </div>
                                                                        </li>
                                                                    </ul>
                                                                    <div class="flex items-center mb-4">
                                                                        <input :id="'altwcheck'+plan.key"
                                                                            :name="'altwcheck'+plan.key" type="checkbox"
                                                                            :value="plan.key"
                                                                            :checked="plan.weekdays[1].length"
                                                                            class="w-4 h-4 text-gray-500 bg-gray-100 rounded border-gray-300 focus:ring-gray-500 dark:focus:ring-gray-400 dark:ring-offset-gray-200 focus:ring-2 dark:bg-gray-300 dark:border-gray-400"
                                                                            @change="setaltw">
                                                                        <label :for="'altwcheck'+plan.key"
                                                                            class="ml-2 text-sm font-medium text-gray-900">Alternate
                                                                            week</label>
                                                                    </div>
                                                                    <input type="hidden" name="plan"
                                                                        :value="plan.key" />
                                                                    <button type="submit"
                                                                        class="text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-200 hover:bg-gray-100 focus:ring-gray-200">Save</button>
                                                                </form>
                                                            </div>
                                                            <div class="p-4 mt-5 pt-2 border-t border-gray-500">
                                                                <button @click="removefromdb(plan.key, 'myplans')"
                                                                    class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Delete</button>
                                                            </div>
                                                        </div>
                                                        <div class="pb-6">
                                                            <form class="space-y-6" action="#"
                                                                @submit.prevent="newPlan">
                                                                <div>
                                                                    <input type="hidden" name="mysheet"
                                                                        :value="sheet.title" />
                                                                </div>
                                                                <button type="submit"
                                                                    class="bg-gray-500 text-white focus:ring-4 focus:outline-none focus:ring-gray-200 font-medium text-sm px-5 py-2.5 text-center mr-2 mb-2 shadow-lg"
                                                                    type="button">
                                                                    <svg class="w-4 h-4 inline-block" fill="none"
                                                                        stroke="currentColor" viewBox="0 0 24 24"
                                                                        xmlns="http://www.w3.org/2000/svg">
                                                                        <path stroke-linecap="round"
                                                                            stroke-linejoin="round" stroke-width="2"
                                                                            d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                                                    </svg>
                                                                    Generate new workout
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                    <div class="mb-6">
                                                        <div class="pt-8">
                                                            <h3 class="text-black mb-6 text-2xl font-bold lg:text-2xl">
                                                                <svg class="w-6 h-6 inline-block" fill="none"
                                                                    stroke="currentColor" viewBox="0 0 24 24"
                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                                        stroke-width="2"
                                                                        d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z">
                                                                    </path>
                                                                </svg>&nbsp;
                                                                My modules
                                                            </h3>
                                                        </div>
                                                        <div class="my-4 max-w-sm"
                                                            v-if="myplans.filter( plan => plan.sheet == sheet.title )">
                                                            <label for="myplans"
                                                                class="block mb-2 text-sm font-medium text-gray-600">Select
                                                                workout to edit</label>
                                                            <select name="plan" id="myplans" @change="setplantochange"
                                                                class="border text-sm block w-full p-2.5 bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500">
                                                                <option value="" disabled selected>Select workout
                                                                </option>
                                                                <option
                                                                    v-for="(plan, index) in myplans.filter( plan => plan.sheet == sheet.title )"
                                                                    :value="plan.key">
                                                                    {{plan.title}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="flex gap-4 flex-wrap">
                                                            <div class="p-6 h-full max-w-sm bg-gray-100 border border-gray-400 shadow-md"
                                                                v-for="module in defmodules.filter(mod => sheet.assignedModules.includes(mod.title)).concat(mymodules.filter(mod => sheet.assignedModules.includes(mod.title)))">
                                                                <a href="#">
                                                                    <h5
                                                                        class="mb-4 text-2xl font-medium tracking-tight text-sand">
                                                                        {{module.title}}</h5>
                                                                </a>
                                                                <div class="mb-4 font-normal text-sand">
                                                                    {{module.description}}
                                                                    <ul>
                                                                        <li v-for="ex in module.exs"
                                                                            class="mb-6 font-normal text-gray-500">
                                                                            <strong class="text-gray-800">{{
                                                                                allexs.find( el => el.id == ex.id ).name
                                                                                }}</strong>
                                                                            <p class="text-lg">{{ allexs.find( el =>
                                                                                el.id == ex.id ).description }}</p>
                                                                            <p class="text-lg font-bold">
                                                                                Reps:&nbsp;<strong
                                                                                    class="text-gray-800">x{{ ex.reps
                                                                                    }}</strong></p>
                                                                            <button
                                                                                @click="sheetplanadd(ex, sheet.title)"
                                                                                class="cursor-pointer inline-flex items-center mt-5 mr-2 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">
                                                                                <svg class="w-4 h-4 inline" fill="none"
                                                                                    stroke="currentColor"
                                                                                    viewBox="0 0 24 24"
                                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                                    <path stroke-linecap="round"
                                                                                        stroke-linejoin="round"
                                                                                        stroke-width="2"
                                                                                        d="M12 6v6m0 0v6m0-6h6m-6 0H6">
                                                                                    </path>
                                                                                </svg>
                                                                                &nbsp; Add to workout
                                                                            </button>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                                <a @click="deletemodule(sheet.key, module.title)"
                                                                    class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">
                                                                    Delete
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-6">
                                                        <div class="pt-8">
                                                            <h3 class="text-black mb-6 text-xl font-bold lg:text-2xl">
                                                                <svg class="w-6 h-6 inline-block" fill="none"
                                                                    stroke="currentColor" viewBox="0 0 24 24"
                                                                    xmlns="http://www.w3.org/2000/svg">
                                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                                        stroke-width="2"
                                                                        d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z">
                                                                    </path>
                                                                </svg>
                                                                My goals
                                                            </h3>
                                                        </div>
                                                        <div v-if="sheet.goals && sheet.goals.length">
                                                            <ol class="relative border-l border-gray-300 py-4">
                                                                <li class="mb-10 ml-4" v-for="goal in sheet.goals">
                                                                    <div :class="[goal.reached ? 'bg-gray-300 shadow-md' : 'bg-gray-300']"
                                                                        class="absolute w-3 h-3 mt-1.5 -left-1.5 border border-gray-100">
                                                                    </div>
                                                                    <h3 class="text-lg font-semibold text-black">
                                                                        {{goal.title}}</h3>
                                                                    <p class="mb-4 text-base font-normal text-gray-500">
                                                                        {{goal.message}}</p>
                                                                    <a @click="setgoalreached(sheet.key, goal.title)"
                                                                        class="inline-flex items-center py-2 px-4 mr-3 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Set
                                                                        as reached <svg class="ml-2 w-3 h-3"
                                                                            fill="currentColor" viewBox="0 0 20 20"
                                                                            xmlns="http://www.w3.org/2000/svg">
                                                                            <path fill-rule="evenodd"
                                                                                d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
                                                                                clip-rule="evenodd"></path>
                                                                        </svg></a>
                                                                    <a @click="deletegoal(sheet.key, goal.title)"
                                                                        class="inline-flex items-center mt-5 py-2 px-4 text-sm font-medium border focus:z-10 focus:ring-4 focus:outline-none focus:text-gray-600 bg-gray-200 text-gray-500 border-gray-400 hover:text-black hover:bg-gray-300 focus:ring-gray-300">Delete</a>
                                                                </li>
                                                            </ol>
                                                        </div>
                                                        <div v-else>
                                                            <p class="pt-4 text-sand">No goals created yet</p>
                                                        </div>
                                                        <a @click="newgoalform()"
                                                            class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-black bg-gray-400 hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-300">
                                                            Add new goal
                                                            <svg class="ml-2 -mr-1 w-4 h-4" fill="currentColor"
                                                                viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                                <path fill-rule="evenodd"
                                                                    d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                                                                    clip-rule="evenodd"></path>
                                                            </svg>
                                                        </a>
                                                        <form v-if="goalform" class="my-6 space-y-6 max-w-sm" action="#"
                                                            @submit.prevent="assigngoaltosheet">
                                                            <div>
                                                                <div class="pb-4">
                                                                    <label for="goal_title"
                                                                        class="block mb-2 text-sm font-medium text-gray-600">Title</label>
                                                                    <input type="text" id="goal_title" name="goal_title"
                                                                        class="border text-sm block w-full p-2.5 bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500"
                                                                        placeholder="HSPU" required>
                                                                </div>
                                                                <div class="pb-4">
                                                                    <label for="motivation_message"
                                                                        class="block mb-2 text-sm font-medium text-gray-500">Your
                                                                        motivation</label>
                                                                    <textarea id="motivation_message"
                                                                        name="motivation_message" rows="4"
                                                                        class="block p-2.5 w-full text-sm border bg-gray-300 border-gray-400 placeholder-gray-400 text-black focus:ring-gray-500 focus:border-gray-500"
                                                                        placeholder="Your motivation message..."></textarea>
                                                                </div>
                                                                <input type="hidden" name="key" :value="sheet.key" />
                                                            </div>
                                                            <button type="submit"
                                                                class="w-full text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-400 hover:bg-gray-300 focus:ring-gray-200">Add</button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div v-else>
                                                <p class="pt-4 text-sand">No modules assigned yet</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Transition>
                </div>
                <footer class="p-4 shadow md:flex md:items-center md:justify-between md:p-6">
                    <span class="text-sm sm:text-center text-gray-500 agumood">© 2022 <a href="."
                            class="hover:underline">RUPE</a>
                    </span>
                    <ul class="flex flex-wrap items-center mt-3 text-sm text-gray-500 sm:mt-0">
                        <li>
                            <a @click="setCurrentPage('home', 'page')" class="mr-4 hover:underline md:mr-6">Home</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('about', 'page')" class="mr-4 hover:underline md:mr-6">about</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('rupe-modules', 'page')" class="mr-4 hover:underline md:mr-6">RUPE
                                programs</a>
                        </li>
                        <li>
                            <a @click="setCurrentPage('my-programs', 'page')" class="hover:underline">my sheets</a>
                        </li>
                    </ul>
                </footer>
            </div>
            <!-- add sheet modal -->
            <Transition name="modal">
                <div v-if="newsheetmodal" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto shadow bg-gray-300">
                            <button type="button" @click="newsheetmodal = false"
                                class="absolute top-3 right-2.5 text-gray-500 bg-transparent text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-200 hover:text-black">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 class="mb-4 text-xl font-medium text-black">Register new sheet
                                </h3>
                                <form class="space-y-6" action="#" @submit.prevent="newSheet">
                                    <div>
                                        <label for="mysheet"
                                            class="block mb-2 text-sm font-medium text-gray-600">Title</label>
                                        <input type="text" name="mysheet" id="mysheet"
                                            class="border text-sm focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5 bg-gray-400 border-gray-500 placeholder-gray-400 text-black"
                                            placeholder="My first sheet" required>
                                    </div>
                                    <button type="submit"
                                        class="w-full text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-200 hover:bg-gray-100 focus:ring-gray-200">Assign</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
            <!-- add module modal -->
            <Transition name="modal">
                <div v-if="newmodulemodal" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto shadow bg-gray-300">
                            <button type="button" @click="newmodulemodal = false"
                                class="absolute top-3 right-2.5 text-gray-500 bg-transparent text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-200 hover:text-black">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 v-if="editmodule.title" class="mb-4 text-xl font-medium text-black">
                                    Edit module</h3>
                                <h3 v-else class="mb-4 text-xl font-medium text-black">
                                    Register new module</h3>
                                <form id="newModuleForm" class="space-y-6" action="#" @submit.prevent="addmoduletodb">
                                    <div class="form-inner">
                                        <div>
                                            <label for="mysheet"
                                                class="block mb-2 text-sm font-medium text-gray-600">Title</label>
                                            <input type="text" name="mymodule" id="mymodule"
                                                class="border text-sm focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5 bg-gray-400 border-gray-500 placeholder-gray-400 text-black"
                                                placeholder="My first module"
                                                :value="[editmodule.title ? editmodule.title : '']" required>
                                            <input type="hidden" name="modulekey"
                                                :value="[editmodule.key ? editmodule.key : '']" />
                                        </div>
                                        <div class="form-inner-excs py-4">
                                            <label for="mysheet"
                                                class="block mb-2 text-sm font-medium text-gray-600">Exercises</label>
                                        </div>
                                        <div v-if="editmodule.title">
                                            <div class="flex" v-for="(modex, index) in editmodule.exs">
                                                <select v-model="modex.id" :name="'exec_'+index"
                                                    class="exe-select border mb-3 text-sm focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5 bg-gray-400 border-gray-500 placeholder-gray-400 text-black mr-3">
                                                    <option v-for="(exl, index) in allexs" :value="exl.id">{{ exl.name
                                                        }}</option>
                                                </select>
                                                <input type="number" :value="modex.reps" :name="'exec_'+index+'_reps'"
                                                    class="border mb-3 text-sm focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5 bg-gray-400 border-gray-500 placeholder-gray-400 text-black flex-1 w-24">
                                            </div>
                                            <a @click="appendinput(modalexec++)"
                                                class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-black bg-gray-400 hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-300">
                                                Add exercise
                                            </a>
                                        </div>
                                        <div v-else>
                                            <a @click="appendinput(modalexec++)"
                                                class="inline-flex items-center mt-5 py-2 px-3 text-md font-medium text-center text-black bg-gray-400 hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-300">
                                                Add exercise
                                            </a>
                                        </div>
                                    </div>
                                    <input type="hidden" name="action" :value="moduleformtype" />
                                    <button type="submit"
                                        class="w-full text-black focus:ring-4 focus:outline-none font-medium text-sm px-5 py-2.5 text-center bg-gray-400 hover:bg-gray-300 focus:ring-gray-200">Assign</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
            <!-- resume modal -->
            <Transition name="modal">
                <div v-if="cleanplan" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto shadow bg-white">
                            <button type="button" @click="cleanplan = null"
                                class="absolute top-3 right-2.5 text-gray-500 bg-transparent text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-200 hover:text-black">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 class="mb-4 text-xl font-medium text-black">
                                    {{cleanplan.title}}
                                </h3>
                                <hr />
                                <div class="my-6">
                                    <div v-if="cleanplan.exs && cleanplan.exs.length">
                                        <ul>
                                            <li class="mb-2" v-for="(ex, index) in cleanplan.exs">
                                                <div class="flex-1" v-if="ex.id">
                                                    <strong class="font-bold">{{ allexs.find( el => el.id == ex.id
                                                        ).name }}</strong>
                                                    <p class="text-lg">{{ allexs.find( el => el.id == ex.id
                                                        ).description }}</p>
                                                    <p class="text-lg font-bold">Reps:&nbsp;<strong
                                                            class="font-bold">x{{ ex.reps }}</strong></p>
                                                </div>
                                                <div v-if="cleanplan.rests.find( el => el.exi == index )" class="my-4">
                                                    Rest: <span class="font-bold">{{ cleanplan.rests.find( el => el.exi == index ).rest }}</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div v-else>
                                        <p class="pt-4 text-gray-800">No exercises added yet</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
            <!-- message modal -->
            <Transition name="modal">
                <div v-if="messagemodal" class="modal-mask">
                    <div class="modal-wrapper relative w-full">
                        <div class="modal-container relative max-w-md h-full md:h-auto shadow bg-gray-300">
                            <button type="button" @click="messagemodal = false"
                                class="absolute top-3 right-2.5 text-gray-500 bg-transparent text-sm p-1.5 ml-auto inline-flex items-center hover:bg-gray-200 hover:text-black">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </button>
                            <div class="py-6 px-6 lg:px-8">
                                <h3 class="mb-4 text-xl font-medium text-black">
                                    {{messagemodal}}
                                </h3>
                            </div>
                        </div>
                    </div>
                </div>
            </Transition>
        </div>
    </div>
    <svg width="0" height="0">
        <filter id='noise' x='0%' y='0%' width='100%' height='100%'>
            <feTurbulence type="fractalNoise" baseFrequency="0" result="NOISE" numOctaves="2" seed="0" />
            <feDisplacementMap in="SourceGraphic" in2="NOISE" scale="40" xChannelSelector="R" yChannelSelector="R">
            </feDisplacementMap>
        </filter>
    </svg>
</body>
<script>

    const { createApp } = Vue

    createApp({
        data() {
            return {
                db: [],
                data: [],
                mysheets: [],
                mymodules: [],
                myplans: [],
                modulesbysheet: [],
                defmodules: [],
                allexs: [],
                currentPage: 'home',
                currentNavType: 'page',
                modal: '',
                assigning: null,
                goalform: null,
                modalexec: 0,
                moduleformtype: 'add',
                newsheetmodal: false,
                newmodulemodal: false,
                messagemodal: false,
                editmodule: {},
                plantochange: '',
                mobilemenuopen: false,
                currentDay: '',
                weekType: false,
                altw: false,
                exrest: false,
                cleanplan: false,
                plantitleedit: false
            }
        },
        methods: {
            async setupData() {

                await fetch('data.json')
                    .then((response) => response.json())
                    .then((json) => this.data = json);

                //extract all modules
                this.data.plans.map(plan => {
                    plan.modules.map(module => {
                        this.defmodules.push(module)
                    })
                });
                //extract all exercises
                this.data.plans.map(plan => {
                    plan.modules.map(module => {
                        module.exs.map(ex => {
                            this.allexs.push(ex)
                        })
                    })
                });

                const today = new Date()
                this.currentDay = today.getDay()

                Date.prototype.getWeek = function () {
                    var date = new Date(this.getTime());
                    date.setHours(0, 0, 0, 0);
                    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
                    var week1 = new Date(date.getFullYear(), 0, 4);
                    return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000
                        - 3 + (week1.getDay() + 6) % 7) / 7);
                }

                this.weekType = today.getWeek() % 2 == 0 ? 0 : 1

                this.db = await this.dbSetup()
                this.mysheets = await this.getsheets()
                this.mymodules = await this.getmodules();
                this.myplans = await this.getplans();

                if (window.location.search) {
                    searchParams = new URLSearchParams(window.location.search);
                    for (const [key, values] of searchParams.entries()) {
                        this.currentPage = values
                    }
                }

                setTimeout(() => {
                    document.getElementById('main').classList.remove('loading')
                }, 500);
            },
            async dbSetup() {
                return new Promise((resolve, reject) => {
                    let request = window.indexedDB.open("rupedb", 10);

                    request.onerror = event => {
                        reject('db not allowed')
                    };
                    request.onsuccess = event => {
                        resolve(event.target.result);
                    };

                    request.onupgradeneeded = event => {

                        //DB CLEAN
                        let DBDeleteRequest = window.indexedDB.deleteDatabase("agumentodb");

                        DBDeleteRequest.onerror = function (event) {
                            console.log("Error deleting database.");
                        };

                        DBDeleteRequest.onsuccess = function (event) {
                            console.log("Database deleted successfully");

                            console.log(event.result); // should be undefined
                        };


                        let dbtoupgrade = event.target.result;
                        let objectStore

                        if (dbtoupgrade.objectStoreNames.contains('mysheets')) {
                            objectStore = event.target.transaction.objectStore("mysheets")
                            console.log('mysheets already exists, not recreating');
                        } else {
                            console.log('mysheets does not exist, creating');
                            objectStore = dbtoupgrade.createObjectStore("mysheets", { autoIncrement: true });
                        }

                        if (!objectStore.indexNames.contains("title")) objectStore.createIndex("title", "title", { unique: false });

                        if (dbtoupgrade.objectStoreNames.contains('mymodules')) {
                            objectStore = event.target.transaction.objectStore("mymodules")
                            console.log('mymodules already exists, not recreating');
                        } else {
                            console.log('mymodules does not exist, creating');
                            objectStore = dbtoupgrade.createObjectStore("mymodules", { autoIncrement: true });
                        }

                        if (!objectStore.indexNames.contains("title")) objectStore.createIndex("title", "title", { unique: false });

                        if (dbtoupgrade.objectStoreNames.contains('myplans')) {
                            objectStore = event.target.transaction.objectStore("myplans")
                            console.log('myplans already exists, not recreating');
                        } else {
                            console.log('myplans does not exist, creating');
                            objectStore = dbtoupgrade.createObjectStore("myplans", { autoIncrement: true });
                        }

                        if (!objectStore.indexNames.contains("id")) objectStore.createIndex("id", "id", { unique: true });
                    };
                })
            },
            async getobjectstore(trans, type) {
                let transaction = this.db.transaction([trans], type);

                transaction.oncomplete = event => {
                    console.log("All done!");
                };

                transaction.onerror = event => { };

                return transaction.objectStore(trans);
            },
            async dbtojson(objstore) {
                return new Promise((resolve, reject) => {
                    let values = []
                    let transaction = this.db.transaction([objstore], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(values);
                    };

                    let objectStore = transaction.objectStore(objstore);

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            values.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async exportdb() {
                let dbexport = {}
                if (this.db) {

                    let dbsheets = await this.dbtojson('mysheets')
                    let dbmodules = await this.dbtojson('mymodules')
                    let dbplans = await this.dbtojson('myplans')
                    dbexport.mysheets = dbsheets
                    dbexport.mymodules = dbmodules
                    dbexport.myplans = dbplans

                    let a = document.createElement("a");
                    let jsonUrl = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(dbexport));

                    document.body.appendChild(a);

                    a.style = "display: none";
                    a.target = '_blank';
                    a.href = jsonUrl;
                    a.download = 'test.json';
                    a.click();

                    document.body.removeChild(a);

                }
            },
            async importtodb(evt) {
                const res = await this.parseJsonFile(evt.target.file.files[0])

                if (res) {
                    let objectStore_s = await this.getobjectstore('mysheets', 'readwrite')
                    let objectStore_m = await this.getobjectstore('mymodules', 'readwrite')
                    let objectStore_p = await this.getobjectstore('myplans', 'readwrite')

                    res.mysheets.map(sheet => {

                        let request = objectStore_s.add(sheet, sheet.title)
                        request.onsuccess = event => {
                            console.log('import successfull')
                        };

                    })
                    res.mymodules.map(module => {

                        let request = objectStore_m.add(module, module.title)
                        request.onsuccess = event => {
                            console.log('import successfull')
                        };

                    })
                    res.myplans.map(plan => {

                        let request = objectStore_p.add(plan, plan.title)
                        request.onsuccess = event => {
                            console.log('import successfull')
                        };

                    })
                }

                this.mymodules = await this.getmodules()
                this.mysheets = await this.getsheets()
            },
            async parseJsonFile(file) {
                return new Promise((resolve, reject) => {
                    const fileReader = new FileReader()
                    fileReader.onload = event => {

                        let filecontent = ''
                        if (event.target.result) {
                            try {
                                filecontent = JSON.parse(event.target.result);
                            } catch (e) {
                                console.log(e.message);
                            }
                        }
                        if (filecontent) resolve(filecontent)

                    }
                    fileReader.onerror = error => reject(error)
                    fileReader.readAsText(file)
                })
            },
            setCurrentPage(page) {
                if ('URLSearchParams' in window) {
                    searchParams = new URLSearchParams(window.location.search);
                    searchParams.set('page', page)
                    newRelativePathQuery = window.location.pathname + '?' + searchParams.toString();
                    history.pushState(null, '', newRelativePathQuery);
                }
                this.currentPage = page
                //goal form close
                this.goalform = false
                //resp menu close
                this.mobilemenuopen = false
            },
            assignmodule(module) {
                if (this.assigning == module) {
                    this.assigning = null
                } else {
                    this.assigning = module
                }
            },
            setplantochange(evt) {
                this.plantochange = evt.target.value
            },
            setaltw(evt) {
                if (evt.target.checked)
                    this.altw = evt.target.value
                else
                    this.altw = false
            },
            setexrest(evt) {
                if (evt.target.checked)
                    this.exrest = evt.target.value
                else
                    this.exrest = false
            },
            cleanresume(plan) {
                this.cleanplan = plan
            },
            async assigntosheet(event) {
                let form = event.target

                let key = form.sheet.value
                let exindex = null
                if (form.exindex) {
                    exindex = form.exindex.value
                }

                let moduleindex = form.moduleindex.value
                let moduletoassign
                if (this.data.plans[exindex]) {
                    moduletoassign = this.data.plans[exindex].modules[moduleindex]
                } else {
                    //get module from db with index moduleindex
                    moduletoassign = await this.getmodule(moduleindex)
                }

                if (key !== undefined) {

                    let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                    let request = objectStore.get(key);
                    let keycheck = null

                    request.onsuccess = event => {
                        //let titleKey = event.target.result.title
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === key) {
                                    const updateData = cursor.value;

                                    if (!updateData.assignedModules) {
                                        updateData.assignedModules = []
                                        updateData.assignedModules.push(moduletoassign.title)
                                    } else {
                                        keycheck = updateData.assignedModules.find(sheetTitle => sheetTitle == moduletoassign.title)
                                        updateData.assignedModules.push(moduletoassign.title)
                                    }

                                    if (!keycheck) {
                                        const request = cursor.update(updateData);
                                        request.onsuccess = function () {
                                            message = 'Module assigned'
                                        };

                                    } else {
                                        message = 'Error, module already assigned'
                                    }

                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.mysheets = await this.getsheets()
                    this.messagemodal = message

                }

            },
            async newPlan() {

                if (event.target && event.target.mysheet.value) {

                    let objectStore = await this.getobjectstore('myplans', 'readwrite')

                    let request = objectStore.add({ title: 'My new workout', sheet: event.target.mysheet.value, exs: [], rests: [], weekdays: [[], []] });
                    let message = ''

                    request.onsuccess = async event => {
                        message = 'added successfull'
                        await this.planRename(event.target.result)
                        this.myplans = await this.getplans()
                        this.messagemodal = message
                    };

                }

            },
            async planRename(plankey, title = '') {

                let objectStore = await this.getobjectstore('myplans', 'readwrite')

                let request = objectStore.get(plankey);

                request.onsuccess = async event => {
                    objectStore.openCursor().onsuccess = function (event) {
                        const cursor = event.target.result;
                        if (cursor) {
                            if (cursor.key == plankey) {
                                const updateData = cursor.value;

                                updateData.title = updateData.title + ' #' + plankey

                                const request = cursor.update(updateData);
                                request.onsuccess = function () {
                                    console.log('renamed successfully');
                                };

                            }
                            cursor.continue();
                        }
                    }
                }

            },
            async planRenameForm(event) {

                let plankey = event.target.plan.value
                let newtitle = event.target.plantitle_edit.value

                let objectStore = await this.getobjectstore('myplans', 'readwrite')

                let request = objectStore.get(plankey);

                request.onsuccess = async event => {
                    objectStore.openCursor().onsuccess = function (event) {
                        const cursor = event.target.result;
                        if (cursor) {
                            if (cursor.key == plankey) {
                                const updateData = cursor.value;

                                updateData.title = newtitle

                                const request = cursor.update(updateData);
                                request.onsuccess = function () {
                                    console.log('renamed successfully');
                                };

                            }
                            cursor.continue();
                        }
                    }
                }

                this.myplans = await this.getplans()
                this.plantitleedit = false

            },
            async setplanweekdays(event) {

                if (event.target && event.target.plan) {

                    let plan = event.target.plan.value
                    let checkboxes = event.target.elements
                    let is_alt_weeks = event.target['altwcheck' + plan].checked

                    let objectStore = await this.getobjectstore('myplans', 'readwrite')

                    let request = objectStore.get(plan);

                    request.onsuccess = event => {
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === parseInt(plan)) {
                                    const updateData = cursor.value;

                                    let selection = [];
                                    let selection_alt = [];
                                    [...checkboxes].map((el, index) => {
                                        if (is_alt_weeks) {
                                            if (index < 7) {
                                                if (el.type == 'checkbox' && el.checked)
                                                    selection.push(el.value)
                                            } else if (index >= 7 && index < 14) {
                                                if (el.type == 'checkbox' && el.checked)
                                                    selection_alt.push(el.value)
                                            }
                                        } else {
                                            if (index < 7) {
                                                if (el.type == 'checkbox' && el.checked)
                                                    selection.push(el.value)
                                            }
                                        }
                                    })

                                    updateData.weekdays[0] = selection
                                    updateData.weekdays[1] = selection_alt

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('plan edited');
                                    };

                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.myplans = await this.getplans()

                }

            },
            async sheetplanadd(ex) {

                if (this.plantochange) {

                    plan = this.plantochange

                    let objectStore = await this.getobjectstore('myplans', 'readwrite')

                    let request = objectStore.get(plan);

                    request.onsuccess = event => {
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === parseInt(plan)) {
                                    const updateData = cursor.value;

                                    if (!updateData.exs) {
                                        updateData.exs = []
                                        updateData.exs.push({ id: ex.id, reps: ex.reps })
                                    } else {
                                        updateData.exs.push({ id: ex.id, reps: ex.reps })
                                    }

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        message = 'Plan edited'
                                    };

                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.mysheets = await this.getsheets()
                    this.myplans = await this.getplans()

                } else {
                    this.messagemodal = 'Error, select a plan'
                }

            },
            async sheetplanaddrest(event) {

                let rest = event.target.rest.value
                let exindex = event.target.ex.value
                let plan = event.target.plan.value

                console.log(rest+'-'+exindex+'-'+plan)

                let objectStore = await this.getobjectstore('myplans', 'readwrite')

                let request = objectStore.get(plan);

                request.onsuccess = event => {
                    objectStore.openCursor().onsuccess = function (event) {
                        const cursor = event.target.result;
                        if (cursor) {
                            if (cursor.key === parseInt(plan)) {
                                const updateData = cursor.value;

                                if (!updateData.rests) {
                                    updateData.rests = []
                                    updateData.rests.push({ exi: exindex, rest: rest })
                                } else {
                                    updateData.rests.push({ exi: exindex, rest: rest })
                                }

                                const request = cursor.update(updateData);
                                request.onsuccess = function () {
                                    message = 'Plan edited'
                                };

                            };
                            cursor.continue();
                        } else {
                            console.log('end cursor');
                        }
                    };
                }

                this.mysheets = await this.getsheets()
                this.myplans = await this.getplans()

            },
            async sheetplanexremove(index, plan) {
                let objectStore = await this.getobjectstore('myplans', 'readwrite')

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == plan && cursor.value.exs) {
                            const updateData = cursor.value;

                            updateData.exs.splice(index, 1);

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.myplans = await this.getplans()
            },
            async planmoveex(plan, extomoveindex, move, sheet) {

                if (sheet !== undefined) {

                    let objectStore = await this.getobjectstore('myplans', 'readwrite')

                    let request = objectStore.get(plan);

                    request.onsuccess = event => {
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {

                                if (cursor.key === plan && cursor.value.exs) {
                                    const updateData = cursor.value;

                                    if (updateData.exs) {
                                        if (extomoveindex !== null) {
                                            if (move == 'down') {
                                                if (extomoveindex < (updateData.exs.length - 1)) {
                                                    let temp = updateData.exs[extomoveindex + 1]
                                                    updateData.exs[extomoveindex + 1] = updateData.exs[extomoveindex]
                                                    updateData.exs[extomoveindex] = temp
                                                }
                                            }
                                            else if (move == 'up') {
                                                if (extomoveindex > 0) {
                                                    let temp = updateData.exs[extomoveindex - 1]
                                                    updateData.exs[extomoveindex - 1] = updateData.exs[extomoveindex]
                                                    updateData.exs[extomoveindex] = temp
                                                }
                                            }
                                        }
                                    }

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('moved')
                                    };

                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.myplans = await this.getplans()

                }

            },
            async newSheet(event) {
                if (event.target && event.target.mysheet.value) {

                    let keycheckmy = this.mysheets.find(sheet => sheet.title == event.target.mysheet.value)

                    if (!keycheckmy) {

                        let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                        let request = objectStore.add({ title: event.target.mysheet.value }, event.target.mysheet.value);
                        let message = ''
                        request.onsuccess = event => {
                            message = 'added successfull'
                        };

                        this.mysheets = await this.getsheets()
                        this.newsheetmodal = false
                        this.messagemodal = message
                    } else {
                        this.messagemodal = 'Error, duplicated key'
                    }

                }
            },
            async addmoduletodb(event) {
                if (event.target && event.target.mymodule.value) {

                    let objectStore = await this.getobjectstore('mymodules', 'readwrite')

                    let message = ''
                    let moduletitle = event.target.mymodule.value

                    let keycheckmy = this.mymodules.find(module => module.title == moduletitle)
                    let keycheckdef = this.defmodules.find(module => module.title == moduletitle)

                    if ((!keycheckmy && !keycheckdef) || event.target.action.value == 'edit') {

                        let modulekey = event.target.modulekey.value
                        let excslist = []
                        allexs = this.allexs;
                        [...event.target.elements].map(el => {
                            if (el.classList.contains('exe-select')) {
                                if (el.value)
                                    excslist.push({ id: el.value, reps: document.getElementsByName(el.name + '_reps')[0].value })
                            }
                        });

                        if (event.target.action.value == 'edit') {

                            objectStore.openCursor().onsuccess = function (event) {
                                const cursor = event.target.result;
                                if (cursor) {
                                    if (cursor.key == modulekey && cursor.value.exs) {
                                        const updateData = cursor.value;

                                        updateData.exs = excslist

                                        const request = cursor.update(updateData);
                                        request.onsuccess = function () {
                                            message = 'Edited module'
                                        };

                                    }
                                    cursor.continue();
                                }
                            }

                        } else {

                            let request = objectStore.add({ title: moduletitle, exs: excslist }, moduletitle);
                            request.onsuccess = event => {
                                message = 'Added module'
                            };

                        }

                        this.mymodules = await this.getmodules()
                        this.newmodulemodal = false
                        this.messagemodal = message

                    } else {
                        this.messagemodal = 'Error, duplicated key'
                    }

                }
            },
            async removefromdb(key, trans) {
                if (key !== undefined) {

                    let objectStore = await this.getobjectstore(trans, 'readwrite')

                    //key start from 1 in db
                    let request = objectStore.delete(key);

                    request.onsuccess = event => {
                        console.log('removed successfull')
                    };

                    request.onerror = event => {
                        console.log('error!!')
                    };

                    this.mysheets = await this.getsheets()
                    this.mymodules = await this.getmodules()
                    this.myplans = await this.getplans()

                }
            },
            async getsheets() {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['mysheets'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(sheets);
                    };

                    let objectStore = transaction.objectStore('mysheets');
                    let sheets = [];

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            cursor.value.key = cursor.key

                            sheets.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async getmodules() {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['mymodules'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(modules);
                    };

                    let objectStore = transaction.objectStore('mymodules');
                    let modules = [];

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            cursor.value.key = cursor.key

                            modules.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async getplans() {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['myplans'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(plans);
                    };

                    let objectStore = transaction.objectStore('myplans');
                    let plans = [];

                    objectStore.openCursor().onsuccess = e => {
                        let cursor = e.target.result;
                        if (cursor) {
                            cursor.value.key = cursor.key

                            plans.push(cursor.value)
                            cursor.continue();
                        }
                    };

                });
            },
            async getmodule(modulekey) {
                return new Promise((resolve, reject) => {
                    let transaction = this.db.transaction(['mymodules'], 'readonly');
                    transaction.oncomplete = e => {
                        resolve(module);
                    };

                    let objectStore = transaction.objectStore('mymodules');
                    const request = objectStore.get(modulekey);
                    let module = {};

                    request.onerror = () => {
                        console.log('The parameter is not a valid key.');
                    }

                    request.onsuccess = () => {
                        module = request.result
                    }

                });
            },
            async newgoalform() {
                if (!this.goalform)
                    this.goalform = true
                else
                    this.goalform = false
            },
            async assigngoaltosheet() {
                let form = event.target

                let key = form.key.value
                let title = form.goal_title.value
                let message = form.motivation_message.value

                if (key !== undefined) {

                    let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                    let request = objectStore.get(key);

                    request.onsuccess = event => {
                        //let titleKey = event.target.result.title
                        objectStore.openCursor().onsuccess = function (event) {
                            const cursor = event.target.result;
                            if (cursor) {
                                if (cursor.key === key) {
                                    const updateData = cursor.value;

                                    if (!updateData.goals) {
                                        updateData.goals = []
                                        updateData.goals.push({ title: title, message: message, reached: false })
                                    } else {
                                        updateData.goals.push({ title: title, message: message, reached: false })
                                    }

                                    const request = cursor.update(updateData);
                                    request.onsuccess = function () {
                                        console.log('Success');
                                    };
                                };
                                cursor.continue();
                            } else {
                                console.log('end cursor');
                            }
                        };
                    }

                    this.mysheets = await this.getsheets()

                }
            },
            async deletemodule(sheetkey, modulekey) {

                let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.assignedModules) {
                            const updateData = cursor.value;

                            let updatedModules = []
                            updateData.assignedModules.map(module => module != modulekey ? updatedModules.push(module) : '')

                            //do the things
                            updateData.assignedModules = updatedModules

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            async deletegoal(sheetkey, goalkey) {

                let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.goals) {
                            const updateData = cursor.value;

                            let goalindex = null
                            updateData.goals.map((goal, index) => goal.title == goalkey ? goalindex = index : '')

                            //do the things
                            updateData.goals.splice(goalindex, 1);

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            async setgoalreached(sheetkey, goalkey) {

                let objectStore = await this.getobjectstore('mysheets', 'readwrite')

                objectStore.openCursor().onsuccess = function (event) {
                    const cursor = event.target.result;
                    if (cursor) {
                        if (cursor.key == sheetkey && cursor.value.goals) {
                            const updateData = cursor.value;

                            let goalindex = null
                            updateData.goals.map((goal, index) => goal.title == goalkey ? goalindex = index : '')

                            //do the things
                            updateData.goals[goalindex].reached = true;

                            const request = cursor.update(updateData);
                            request.onsuccess = function () {
                                console.log('Success');
                            };

                        }
                        cursor.continue();
                    }
                }
                this.mysheets = await this.getsheets()
            },
            appendinput(count) {

                //count edit fix
                if (this.editmodule.exs) {
                    if (this.editmodule.exs.length) {
                        count += this.editmodule.exs.length
                    }
                }

                let row = document.createElement('div')
                row.classList.add('flex')

                let input = document.createElement('select')
                input.setAttribute('name', 'exec_' + count)
                input.classList.add('exe-select', 'border', 'mb-3', 'text-sm', 'focus:ring-gray-500', 'focus:border-gray-500', 'block', 'w-full', 'p-2.5', 'bg-gray-400', 'border-gray-500', 'placeholder-gray-400', 'text-black', 'mr-3')

                let temp = document.createElement('option')
                temp.setAttribute('value', '')
                temp.textContent = '---'
                input.append(temp)

                this.allexs.map((ex, index) => {
                    temp = document.createElement('option')
                    temp.setAttribute('value', ex.name)
                    temp.textContent = ex.name
                    input.append(temp)
                })

                let reps = document.createElement('input')
                reps.setAttribute('type', 'number')
                reps.setAttribute('value', '5')
                reps.setAttribute('name', 'exec_' + count + '_reps')
                reps.classList.add('border', 'mb-3', 'text-sm', 'focus:ring-gray-500', 'focus:border-gray-500', 'block', 'w-full', 'p-2.5', 'bg-gray-400', 'border-gray-500', 'placeholder-gray-400', 'text-black', 'flex-1', 'w-24')

                row.append(input)
                row.append(reps)

                document.querySelector('#newModuleForm .form-inner-excs').append(row)
            }
        },
        mounted() {
            this.setupData()
        }
    }).mount('#app')

</script>

</html>